import{d as w,J as C,h as y,l as T,o,i as u,w as h,c as i,p as f,j as d,u as c,A as b,F as v,q as F,al as S,a as m,e as x}from"./main-2290994d.js";import{C as A}from"./CustomColumn-c63128eb.js";import{C as B,a as L}from"./ChipsList-0fe31c28.js";import{F as I}from"./FieldCheckbox-4d368f68.js";const D={key:0,class:"hint"},E={key:1},K=m("div",{class:"spinner"},null,-1),M=[K],$=["onClick"],j={key:0},q=m("i",{class:"fas fa-spinner tw-animate-spin"},null,-1),z=[q],J={class:"tw-flex-auto tw-truncate"},O=w({__name:"DropdownAddTags",props:{modelValue:{},entityType:{},entityIds:{}},emits:["update:modelValue"],setup(g,{emit:V}){const a=g,l=C();l.refetch();const n=y(""),r=y(new Set),p=T(()=>l.tags.filter(e=>!("tags"in a.modelValue?a.modelValue.tags:a.modelValue).map(s=>typeof s=="string"?s:s.name).includes(e.name)).sort((e,s)=>s.count-e.count).slice(0,10));function k(e){_(n.value),n.value="",e.target.blur()}async function _(e){Array.isArray(a.modelValue)?V("update:modelValue",[...a.modelValue,e]):(r.value.add(e),await l.tagAssign(a.entityType,a.entityIds,[e]).execute(),r.value.delete(e))}return(e,s)=>(o(),u(A,{space:"2"},{default:h(()=>[p.value.length>0?(o(),i("div",D,f(e.$t("popularTags")),1)):d("",!0),c(l).isFetching?(o(),i("div",E,M)):c(l).error?(o(),i(v,{key:2},[b(f(c(l).error),1)],64)):p.value.length>0?(o(),u(B,{key:3},{default:h(()=>[(o(!0),i(v,null,F(p.value,t=>(o(),u(L,{key:t.id+String(t.color),color:t.color,"bg-color":t.bg_color,class:"smaller"},{default:h(()=>[m("a",{onClick:x(()=>{!r.value.has(t.name)&&_(t.name)},["prevent"])},[r.value.has(t.name)?(o(),i("span",j,z)):d("",!0),m("span",J,f(t.name),1)],8,$)]),_:2},1032,["color","bg-color"]))),128))]),_:1})):d("",!0),c(l).isFetching?d("",!0):(o(),u(I,{key:4,modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=t=>n.value=t),modelModifiers:{trim:!0},disabled:r.value.size,type:"text",placeholder:e.$t("createNewTag"),onKeyup:s[1]||(s[1]=S(t=>{n.value.length&&k(t)},["enter"]))},null,8,["modelValue","disabled","placeholder"]))]),_:1}))}});export{O as _};
