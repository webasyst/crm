import{U as p}from"./UserPic-88a434b2.js";import{a as _}from"./InputWithContacts.vue_vue_type_script_setup_true_lang-4f517706.js";import{$ as v,a as h,X as w,N as x,d as V,t as B,o as I,b as S,w as d,i as a,e as m,k as f,B as U}from"./main-14ee4927.js";const g=v("users",()=>{const l=h([]),{data:o,isFetching:i,error:n,isFinished:r,execute:s}=w("crm.user.list").get().json();x(()=>{Array.isArray(o.value)&&(l.value=o.value)});function u(){r.value&&s()}return{users:l,isFetching:i,error:n,refetch:u}}),y={class:"icon size-20"},z=["title"],C={class:"tw-flex tw-items-center tw-space-x-2"},F={class:"icon size-20"},k=["title"],A=V({__name:"InputWithUsers",props:{modelValue:{},isMultiple:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(l,{emit:o}){const i=l,n=g(),{users:r}=B(n);n.refetch();const s=h([]);function u(c){s.value=c.length?r.value.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())):r.value;const t=s.value.findIndex(e=>e.id===U.user.id);if(t>-1){const e=s.value.splice(t,1)[0];s.value.splice(0,0,e)}}return(c,t)=>(I(),S(_,{items:s.value,value:i.modelValue,"is-multiple":i.isMultiple,placeholder:c.$t("search"),onInput:u,onFocus:u,onUpdate:t[0]||(t[0]=e=>{o("update:modelValue",e)})},{item:d(({item:e})=>[a("div",y,[m(p,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate",title:e.name},f(e.name),9,z)]),listItem:d(({item:e})=>[a("div",C,[a("div",F,[m(p,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate small",title:e.name},f(e.name),9,k)])]),_:1},8,["items","value","is-multiple","placeholder"]))}});export{A as _};
