import{d as A,H as se,bh as z,o as r,b as I,w as C,i as a,bi as oe,a as g,O as ne,ac as le,ao as ie,P as G,c as h,h as J,v as Q,g as b,a2 as X,r as re,q as K,s as Z,_ as ee,I as ce,a9 as ue,bj as de,A as B,aX as fe,ap as H,j as pe,F as M,l as L,e as ve,m as P,k as S,f as F,N as me,ad as Y,n as R}from"./main-49799bbb.js";import{D as he}from"./DropdownModal-424b732d.js";import{u as _e}from"./useSortable-2cae4f7d.js";import{D as ye}from"./DropDown-a179a782.js";import{b as be}from"./index-55296fc3.js";const ge=a("button",{class:"button circle"},[a("i",{class:"fas fa-plus"})],-1),Qe=A({__name:"TabsAddEntityButton",props:{entityType:{},entityId:{}},setup(c){const s=c,{t:o}=se(),d=[{label:o("addNoteOrFile"),classIcon:"fas fa-sticky-note",clickHandler:()=>{z.push({name:`${s.entityType}NotesTab`,query:{focus:"1"}})}},{label:o("addReminder"),classIcon:"fas fa-check-circle",clickHandler:()=>{z.push({name:`${s.entityType}RemindersTab`,query:{focus:"1"}})}},{label:o("addInvoice"),classIcon:"fas fa-file-invoice-dollar",clickHandler:()=>{z.push({name:`${s.entityType}InvoicesTab`,query:{is_new:"1"}})}}];return(f,v)=>(r(),I(he,{items:d},{default:C(()=>[ge]),_:1}))}}),te=c=>(K("data-v-8af80abb"),c=c(),Z(),c),we={class:"tw-sticky tw-left-0 tw-z-10"},ke=te(()=>a("span",{class:"icon size-16"},[a("i",{class:"fas fa-chevron-left"})],-1)),Te=[ke],Ce=te(()=>a("span",{class:"icon size-16"},[a("i",{class:"fas fa-chevron-left"})],-1)),Se=[Ce],Ne=A({__name:"HorizontalScrollContainer",props:{step:{default:90},fadeColor:{default:"var(--background-color-blank)"}},setup(c){const s=c;oe(m=>({ba883736:m.fadeColor}));const o=g(null),d=g(!1),f=g(0),{x:v,arrivedState:N}=ne(o,{behavior:"smooth"});return le(o,m=>{const p=m[0];f.value=p.target.clientHeight,d.value=p.target.scrollWidth>p.target.clientWidth}),ie(()=>{o.value&&(f.value=o.value.clientHeight,d.value=o.value.scrollWidth>o.value.clientWidth)}),G(d,()=>{N.right=!1}),(m,p)=>(r(),h("div",{ref_key:"scrollableRef",ref:o,class:"tw-relative tw-overflow-x-scroll tw-scrollbar-hide"},[a("div",we,[J(a("div",{class:"arr -tw-left-2",style:X({height:`${f.value}px`}),onClick:p[0]||(p[0]=_=>v.value-=s.step)},Te,4),[[Q,d.value&&b(v)>0]]),J(a("div",{class:"arr tw-right-0 tw-rotate-180",style:X({height:`${f.value}px`}),onClick:p[1]||(p[1]=_=>v.value+=s.step)},Se,4),[[Q,d.value&&!b(N).right]])]),re(m.$slots,"default")],512))}});const xe=ee(Ne,[["__scopeId","data-v-8af80abb"]]),V=c=>(K("data-v-3822a540"),c=c(),Z(),c),$e=V(()=>a("div",{class:"skeleton-line"},null,-1)),Re=[$e],Ie=["data-id"],Oe=["href","onClick"],De={key:0,class:"count"},Ee={key:0,class:"nowrap tw-ml-1 tw-py-3"},ze={class:"button light-gray transparent rounded custom-px-4"},Be=V(()=>a("span",{class:"icon size-16 text-light-gray"},[a("i",{class:"fas fa-chevron-down"})],-1)),He=["data-id"],Me=["href","onClick"],Le=["title"],Fe={key:0,class:"count tw-flex-none"},Ae=V(()=>a("canvas",{id:"tabs-canvas",class:"hidden"},null,-1)),Ve=A({__name:"TabList",props:{entityType:{},value:{},isFetching:{type:Boolean},fadeColor:{}},setup(c){const s=c,o=ce(be),d=g(null),f=g(null),v=g(null),{width:N}=ue(v),{tabsOrder:m,tabsOrderMap:p}=de(s.entityType),_=g(new Map),w=B(()=>[...s.value].sort((t,n)=>p.value[t.routeName]-p.value[n.routeName])),O=B(()=>w.value.filter(t=>_.value.get(t.routeName))),x=B(()=>_.value.size>0?w.value.filter(t=>!_.value.get(t.routeName)):[]),q=()=>{for(const t of w.value)_.value.set(t.routeName,!0)},ae=(t,n)=>{const l=document.getElementById("tabs-canvas");if(l){const e=l.getContext("2d");if(e)return e.font=n,e.measureText(t).width}return 0},W=t=>{const l="1rem sans-serif";let e=0;for(let i=0;i<t.length;i++)e+=ae(t[i].name,l)+24;return e-24};async function D(t=!1){if(!v.value)return;const n=[...w.value],l=()=>{var u;const i=f.value?58:0;return t&&((u=f.value)==null?void 0:u.children.length)===1?0:i},e=l();if(!(W(n)<v.value.clientWidth-e))for(let i=0;i<w.value.length;i++){const u=n.pop();if(_.value.set(u==null?void 0:u.routeName,!1),await Y(),W(n)<v.value.clientWidth-(t?e:l()))break}}G(()=>s.value,()=>{if(!s.value.length)return;fe(()=>s.isFetching,async()=>{m.value.length||s.value.forEach(n=>{m.value.push(n.routeName)}),q(),await Y(),D()},{immediate:!s.isFetching})},{immediate:!!s.value,deep:!0});let E,$;H(O,t=>{d.value&&(E&&E.stop(),t.length&&(E=U(d.value,t)))},{immediate:!0,debounce:250}),H(x,t=>{f.value&&($&&$.stop(),t.length&&($=U(f.value,t)))},{immediate:!0,debounce:250}),H(N,(t,n)=>{t>n&&$&&q(),D(t>n)},{debounce:200});function U(t,n){return _e(t,n,{handle:".handle",group:"tabs",animation:150,forceFallback:!0,fallbackOnBody:!0,fallbackTolerance:5,delay:150,delayOnTouchOnly:!0,onStart:()=>{document.querySelectorAll("iframe").forEach(l=>{l.classList.add("tw-pointer-events-none")})},onEnd:l=>{var k,T;document.querySelectorAll("iframe").forEach(y=>{y.classList.remove("tw-pointer-events-none")});const{id:e}=l.item.dataset;typeof e=="string"&&(l.to.classList.contains("tabs-dropdown-list")?_.value.set(e,!1):l.to.classList.contains("tabs-main-list")&&_.value.set(e,!0));const i=[...((k=d.value)==null?void 0:k.children)||[],...((T=f.value)==null?void 0:T.children)||[]].map(y=>y.dataset.id),u=[...m.value];for(let y=0;y<u.length;y++){const j=u[y];i.includes(j)||i.splice(y,0,j)}m.value=i,setTimeout(D)}})}return(t,n)=>{const l=pe("router-link");return r(),h("div",{ref_key:"tabsContainerRef",ref:v,class:"tw-flex-auto tw-overflow-hidden tw-mx-2"},[(r(),I(me(b(o)?xe:"div"),{"fade-color":s.fadeColor||"var(--background-color)",class:"tw-select-none md:tw-flex"},{default:C(()=>[(r(),h("ul",{key:JSON.stringify(O.value),ref_key:"mainUlRef",ref:d,class:"tabs tabs-main-list overflow-arrows tw-flex-none"},[s.isFetching?(r(),h(M,{key:0},L(7,e=>a("li",{key:e,class:"skeleton tw-w-16"},Re)),64)):(r(!0),h(M,{key:1},L(b(o)?w.value:O.value,e=>(r(),I(l,{key:e.routeName,to:{name:e.routeName},replace:"",custom:""},{default:C(({isActive:i,href:u,navigate:k})=>[a("li",{class:R([{selected:i,handle:!b(o)},"tab-item"]),"data-id":e.routeName},[a("a",{href:u,class:R(t.$constant.parentAppDisableRouterClass),onClick:T=>k(T).then(()=>typeof e.onClick=="function"?e.onClick():null)},[a("span",null,[P(S(e.name)+" ",1),e.count?(r(),h("span",De,S(e.count),1)):F("",!0)])],10,Oe)],10,Ie)]),_:2},1032,["to"]))),128))])),!b(o)&&x.value.length?(r(),h("div",Ee,[ve(ye,{"fallback-on-open":!0,hover:!0,"strategy-fixed":!0},{body:C(()=>[(r(),h("ul",{key:JSON.stringify(x.value),ref_key:"dropdownUlRef",ref:f,class:"menu tabs-dropdown-list"},[(r(!0),h(M,null,L(x.value,e=>(r(),I(l,{key:e.routeName,to:{name:e.routeName},replace:"",custom:""},{default:C(({isActive:i,href:u,navigate:k})=>[a("li",{class:R([{selected:i,handle:!b(o)},"tab-item"]),"data-id":e.routeName},[a("a",{href:u,class:R([t.$constant.parentAppDisableRouterClass,"!tw-py-3"]),onClick:T=>k(T).then(()=>typeof e.onClick=="function"?e.onClick():null)},[a("span",{title:e.name,class:"tw-truncate"},S(e.name),9,Le),e.count?(r(),h("span",Fe,S(e.count),1)):F("",!0)],10,Me)],10,He)]),_:2},1032,["to"]))),128))]))]),default:C(()=>[a("button",ze,[Be,P(" "+S(t.$t("more")),1)])]),_:1})])):F("",!0),Ae]),_:1},8,["fade-color"]))],512)}}});const Xe=ee(Ve,[["__scopeId","data-v-3822a540"]]);export{Xe as T,Qe as _};
