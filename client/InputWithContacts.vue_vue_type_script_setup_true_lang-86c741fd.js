import{U as l}from"./UserPic-87c13a4a.js";import{a as _}from"./InputWithUsers.vue_vue_type_script_setup_true_lang-b6c3d351.js";import{d as h,a as f,ad as v,o as V,b as w,w as i,i as s,e as c,k as u,g as x,J as y}from"./main-ec0df6a4.js";const I={class:"icon size-20"},$=["title"],C={class:"tw-flex tw-items-center tw-space-x-2"},B={class:"icon size-20"},z=["title"],k=h({__name:"InputWithContacts",props:{modelValue:{default:()=>[]},isMultiple:{type:Boolean,default:!0},isCompany:{type:Boolean},textValue:{},onEnter:{},onItemSelect:{}},emits:["update:modelValue"],setup(r,{emit:m}){const t=r,o=f([]),p=v(async a=>{const n=a.includes("@")?"email":/^[+\-0-9() ]+$/.test(a)?"phone":"name.name",{data:e}=await y(`crm.contact.list?hash=crmSearch/contact_info.${n}*=${encodeURIComponent(`${a}${t.isCompany?"&contact_info.contact_type.company=1":""}`)}&limit=10`).get().json();e.value&&(o.value=e.value.data)},300);return(a,n)=>(V(),w(_,{items:o.value.filter(e=>!t.modelValue.map(d=>d.id).includes(e.id)),value:t.modelValue,"text-value":t.textValue,"is-multiple":t.isMultiple,placeholder:a.$t("search"),"on-enter":t.onEnter,"on-item-select":t.onItemSelect,onInput:x(p),onUpdate:n[0]||(n[0]=e=>{m("update:modelValue",e)})},{item:i(({item:e})=>[s("div",I,[c(l,{url:e.userpic,size:20},null,8,["url"])]),s("span",{class:"tw-truncate",title:e.name},u(e.name),9,$)]),listItem:i(({item:e})=>[s("div",C,[s("div",B,[c(l,{url:e.userpic,size:20},null,8,["url"])]),s("span",{class:"tw-truncate small",title:e.name},u(e.name),9,z)])]),_:1},8,["items","value","text-value","is-multiple","placeholder","on-enter","on-item-select","onInput"]))}});export{k as _};
