import{d as $,o as t,b,c as a,k as e,r as B,Q as D,y as N,U as R,a7 as W,aa as _,g as s,w as h,m as i,i as c,F as l,p as I,e as C,f as M,l as f,W as V}from"./main-07d84941.js";import{U as x}from"./UserPic-6b99ec27.js";import{W as P}from"./WaSpinner-40f3d131.js";const U={key:1},j=$({__name:"WaDialogLoading",props:{isFetching:{type:Boolean},error:{}},setup(g){const d=g;return(r,m)=>d.isFetching?(t(),b(P,{key:0})):d.error?(t(),a("div",U,e(r.error),1)):B(r.$slots,"default",{key:2})}}),z=["disabled","onClick"],A={key:0},E={class:"text-orange"},Q={class:"tw-flex tw-flex-auto tw-w-1/2 tw-space-x-2 tw-items-center"},T={class:"tw-truncate"},q={class:"tw-flex-none"},G={class:"tw-whitespace-nowrap"},O=$({__name:"FormContactDelete",props:{contactIds:{},disableContactsPageRedirect:{type:Boolean}},emits:["close"],setup(g,{emit:d}){const r=g,m=D(),k=N(),u=k.deleteContacts(r.contactIds),o=R(`crm.contact.links?${W.stringify({id:r.contactIds})}`).get().json();async function F(){if(o.error.value){o.execute();return}await u.execute()&&(d("close"),r.disableContactsPageRedirect||m.push(k.lastRouteLocation?k.lastRouteLocation:{name:"contacts"}))}return(n,v)=>(t(),b(V,{onClose:v[0]||(v[0]=p=>d("close"))},_({header:h(()=>[i(e(n.$t("deleteContacts",r.contactIds.length)),1)]),submit:h(()=>[c("button",{disabled:s(o).isFetching.value||s(u).isFetching.value,onClick:I(F,["prevent"])},[s(o).isFetching.value?(t(),a(l,{key:0},[i(e(n.$t("checkingLinks")),1)],64)):s(o).error.value?(t(),a(l,{key:1},[i(e(n.$t("recheckLinks")),1)],64)):s(u).isFetching.value?(t(),a(l,{key:2},[i(e(n.$t("deleting")),1)],64)):(t(),a(l,{key:3},[i(e(n.$t("deleteAnyway")),1)],64))],8,z)]),default:h(()=>[C(j,{"is-fetching":s(o).isFetching.value,error:s(o).error.value},_({_:2},[s(o).data.value&&"linked_contacts"in s(o).data.value?{name:"default",fn:h(()=>[c("p",null,e(n.$t("deleteContactsMessage1")),1),s(o).data.value.linked_contacts.length?(t(),a("p",A,[c("strong",E,e(n.$t("importantNote")),1),i(" "+e(n.$t("deleteContactsMessage2"))+" "+e(n.$t("deleteContactsMessage3")),1)])):M("",!0),(t(!0),a(l,null,f(s(o).data.value.linked_contacts,p=>(t(),a("div",{key:p.id},[(t(!0),a(l,null,f(p.links,(y,L)=>(t(),a("div",{key:L},[(t(!0),a(l,null,f(y.roles,(w,S)=>(t(),a("div",{key:S,class:"tw-flex tw-space-x-2 tw-justify-between tw-py-1 bordered-bottom tw-text-sm"},[c("div",Q,[C(x,{url:p.userpic,size:16},null,8,["url"]),c("div",T,e(p.name),1),c("div",q,e(y.app)+"/"+e(w.role),1)]),c("div",G,e(n.$t("links",w.count)),1)]))),128))]))),128))]))),128))]),key:"0"}:void 0]),1032,["is-fetching","error"])]),_:2},[s(u).isFetching.value?void 0:{name:"error",fn:h(()=>[i(e(s(u).error.value),1)]),key:"0"}]),1024))}});export{j as _,O as a};
