import{ax as y,M as B,d as b,$ as g,h,o as u,i as D,L as $,w as d,a as n,p as l,c as p,j as w,A as m,F as v,b as N,a0 as F,e as S,B as C,be as M}from"./main-46836c41.js";import{B as V}from"./ButtonSubmit-c3bae343.js";function P(i,t=!1){const{deleteDealsByIdsInList:e}=y();return B(`crm.deal.delete${t?"":`?id=${i[0]}`}`,{immediate:!1,afterFetch(s){return s.response.ok&&e(i),s}}).delete(t?{id:i}:null)}const R={class:"gray"},E={key:0,class:"tw-ml-2 small break-words"},I={class:"semibold"},L=n("i",{class:"state-caution fas fa-exclamation-triangle"},null,-1),T={class:"state-error"},z=b({__name:"FormDealDelete",props:{ids:{},isBulkMode:{type:Boolean},dealName:{},disableDealsPageRedirect:{type:Boolean},callbackSuccess:{type:Function}},emits:["close"],setup(i,{emit:t}){const e=i,s=g(),o=h(""),r=h(!1);async function c(){var k;o.value="",r.value=!0;const{error:a,response:f,execute:_}=P(e.ids,e.isBulkMode);await _(),r.value=!1,(k=f.value)!=null&&k.ok?(typeof e.callbackSuccess=="function"&&e.callbackSuccess(),e.disableDealsPageRedirect?t("close"):s.push({name:"deals"}).then(()=>{t("close")})):o.value=a.value?a.value:null}return(a,f)=>(u(),D(F,{"use-cancel-as-button-label":"","hide-close-icon":"",onClose:f[0]||(f[0]=_=>t("close"))},$({header:d(()=>[n("span",R,l(a.$t(e.isBulkMode?"confirmDeleteDeals":"delete",a.ids.length)),1),!e.isBulkMode&&e.dealName?(u(),p("span",E,l(e.dealName),1)):w("",!0)]),default:d(()=>[e.isBulkMode?(u(),p(v,{key:0},[n("p",null,l(a.$t("contactsWillNotBeDeleted")),1),n("p",I,[L,m(" "+l(a.$t("dealDeletionCannotBeUndone")),1)])],64)):(u(),p(v,{key:1},[m(l(a.$t("confirmDeleteDeal")),1)],64))]),submit:d(()=>[N(V,{bg:"red","is-fetching":r.value,onClick:c},{default:d(()=>[m(l(a.$t("delete")),1)]),_:1},8,["is-fetching"])]),_:2},[o.value?{name:"error",fn:d(()=>[n("span",T,l(o.value),1)]),key:"0"}:void 0]),1024))}}),U=n("span",{class:"icon size-20"},[n("i",{class:"fas fa-arrow-left"})],-1),A=[U],O=b({__name:"DealNavigateBack",setup(i){async function t(e){if(C.webView){const{emitter:c}=await M(()=>import("./main-46836c41.js").then(a=>a.bF),[],import.meta.url);c.emit("spa:navigateBack");return}const{back:s,content_uri:o}=window.history.state,r=c=>/\/deal\/\d+\/\w+/.test(c);typeof s=="string"&&!r(s)||typeof o=="string"&&!r(o)?e.back():e.push({name:"deals"})}return(e,s)=>(u(),p("a",{style:{color:"var(--deal-color-gray-secondary)"},onClick:s[0]||(s[0]=S(o=>t(e.$router),["prevent"]))},A))}});export{O as _,z as a};
