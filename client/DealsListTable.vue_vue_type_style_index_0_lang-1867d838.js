import{d as M,z as u,o as s,c as t,F as L,e as v,i as a,k as w,b as x,h as z,g as m,m as O,n as g,v as E,p as V,r as T,f as o,a as R,S as F,a4 as j,a5 as U,aj as Y,j as H,V as P,l as Q,w as B}from"./main-512a5cdd.js";import{_ as X,a as q,b as G,c as J,d as K}from"./DealsItemAmount.vue_vue_type_style_index_0_lang-dbb4ce18.js";import{d as Z}from"./dayjs-63c9a14c.js";import{v as ee}from"./vTooltip-c8fe82a0.js";import{U as S}from"./UserPic-2094e1a0.js";import{_ as se}from"./ContactsListItemAction.vue_vue_type_style_index_0_lang-425ad307.js";import{d as te}from"./date-295c47f6.js";import{b as le}from"./index-f44a2c60.js";import{S as ie}from"./SkeletonList-675defe7.js";import{E as ae}from"./EmptyList-256bbb87.js";const oe={key:0,class:"deals-item-stage__closed"},ne={class:"deals-item-stage__text"},de={class:"deals-item-stage__text"},ce={class:"deals-item-stage__closed-datetime"},re={key:1,class:"deals-item-stage__open"},_e={key:1,class:"icon size-12 tw-flex",style:{color:"var(--deal-color-gray-primary)"}},me=a("i",{class:"fas fa-info-circle"},null,-1),ue=[me],pe={class:"deals-item-stage__text"},ve=M({__name:"DealsListItemStage",props:{deal:{},closed:{type:Boolean},isMobile:{type:Boolean},fontNormal:{type:Boolean}},setup(y){const e=y,l=u(()=>Z(e.deal.closed_datetime)),p=u(()=>l.value.isYesterday()),c=u(()=>l.value.isToday()),r=u(()=>l.value.format("HH:mm")),_=u(()=>l.value.format("L")),b=u(()=>e.isMobile?14:10);return(f,A)=>{var C,i;return s(),t("div",{class:g(["deals-item-stage",e.fontNormal||e.isMobile?"tw-font-normal":"tw-font-semibold",{"deals-item-stage--mobile":e.isMobile}])},[e.closed?(s(),t("div",oe,[e.deal.status_id==="WON"?(s(),t(L,{key:0},[v(S,{size:b.value,"fa-icon":"flag-checkered","icon-color":e.deal.stage.color},null,8,["size","icon-color"]),a("div",ne,w(f.$t("won")),1)],64)):(s(),t(L,{key:1},[v(S,{size:b.value,"fa-icon":"ban","icon-color":e.deal.stage.color},null,8,["size","icon-color"]),a("div",de,w(f.$t("lost")),1)],64)),a("span",ce,w(p.value?`${f.$t("yesterday")} ${r.value}`:c.value?`${f.$t("today")} ${r.value}`:_.value),1)])):(s(),t("div",re,[(C=e.deal.stage)!=null&&C.color?(s(),x(S,{key:0,"disable-rounded":"","bg-color":e.deal.stage.color,size:b.value},null,8,["bg-color","size"])):(s(),t("span",_e,ue)),z((s(),t("div",pe,[O(w(e.deal.stage?e.deal.stage.color?e.deal.stage.name:f.$t("stageDeleted"):f.$t("funnelDeleted")),1)])),[[m(ee),(i=e.deal.stage)==null?void 0:i.name,void 0,{"top-start":!0,500:!0}]])]))],2)}}});const fe={class:"deals-item-last_action"},he={ref:"lastActionRef",class:"deals-item-last_action__inner",style:{"min-width":"170px"}},ge=M({__name:"DealsListItemLastAction",props:{lastAction:{},truncateText:{type:Boolean},disableTooltip:{type:Boolean}},setup(y){const e=y;return(l,p)=>(s(),t("div",fe,[a("div",he,[v(se,{action:e.lastAction,"truncate-text":e.truncateText,"disable-line-clamp":!0,"disable-tooltip":e.disableTooltip},null,8,["action","truncate-text","disable-tooltip"])],512)]))}}),ye={key:1,class:"deal-list__item item-stage_id"},we={key:2,class:"deal-list__item item-name"},be={key:3,class:"deal-list__item item-states"},$e={key:4,class:"deal-list__item item-create_datetime"},ke={class:"deals-item-create_datetime mobile:tw-text-[var(--deal-color-gray-secondary)] mobile:tw-text-[13px]"},xe={key:0,class:"gray tw-mr-1"},Ce={class:"md:tw-contents tw-col-span-2 tw-flex tw-flex-row-reverse tw-items-center tw-justify-between"},Te={key:0,class:"deal-list__item item-amount"},Le={key:1,class:"deal-list__item item-user_name"},Ve={key:6,class:"deal-list__item item-last_action"},Me=M({__name:"DealsListItem",props:{deal:{},useColumnsIds:{},isSelected:{type:Boolean},isMobile:{type:Boolean},isTileView:{type:Boolean}},setup(y){const e=y,l=u(()=>r=>e.useColumnsIds.includes(r)),p=u(()=>e.deal.status_id!=="OPEN"),c=u(()=>te(e.deal.create_datetime));return(r,_)=>(s(),t("div",{class:g(["deal-list__row",{highlighted:e.isSelected,"deal-list__row--deal-closed":p.value}])},[l.value("checkbox")?z((s(),t("div",{key:0,class:"deal-list__item deal-list__item--not-opacity",onClick:_[0]||(_[0]=V(()=>{},["stop"]))},[T(r.$slots,"checkbox")],512)),[[E,!e.isMobile]]):o("",!0),l.value("stage_id")?(s(),t("div",ye,[v(ve,{deal:e.deal,closed:p.value,"is-mobile":e.isMobile,"font-normal":e.isTileView},null,8,["deal","closed","is-mobile","font-normal"])])):o("",!0),l.value("name")?(s(),t("div",we,[v(X,{deal:e.deal,"use-userpic":!e.isMobile&&!e.isTileView,"disable-tootltip":e.isMobile||e.isTileView,size:e.isMobile||e.isTileView?"15px":null},null,8,["deal","use-userpic","disable-tootltip","size"])])):o("",!0),l.value("states")?(s(),t("div",be,[v(q,{deal:e.deal},null,8,["deal"])])):o("",!0),l.value("create_datetime")?(s(),t("div",$e,[a("div",ke,[e.isTileView?(s(),t("span",xe,w(r.$t("created")),1)):o("",!0),a("span",{class:g({"tw-lowercase":e.isTileView})},w(c.value),3)])])):o("",!0),a("div",Ce,[l.value("amount")?(s(),t("div",Te,[v(G,{deal:e.deal,size:e.isTileView?"base":e.isMobile?"lg":void 0,"swap-icon":e.isMobile,"big-icon":e.isMobile},null,8,["deal","size","swap-icon","big-icon"])])):o("",!0),l.value("user_name")?(s(),t("div",Le,[e.deal.user?(s(),x(J,{key:0,user:e.deal.user,"align-right":e.isTileView,"default-color":e.isMobile||e.isTileView,"disable-tootltip":e.isMobile},null,8,["user","align-right","default-color","disable-tootltip"])):o("",!0)])):o("",!0)]),l.value("tags")&&!e.isMobile?(s(),t("div",{key:5,class:"deal-list__item deal-list__item--not-opacity item-tags",onClick:_[1]||(_[1]=V(()=>{},["prevent"]))},[v(K,{tags:e.deal.tags,"disable-overflow-soft":e.isTileView,small:e.isTileView},null,8,["tags","disable-overflow-soft","small"])])):o("",!0),l.value("last_action")&&!e.isMobile?(s(),t("div",Ve,["last_action"in e.deal?(s(),x(ge,{key:0,"last-action":e.deal.last_action,"truncate-text":e.isTileView,"disable-tooltip":e.isTileView},null,8,["last-action","truncate-text","disable-tooltip"])):o("",!0)])):o("",!0)],2))}});const Ie={class:"deals-list__wrapper"},Se=a("i",{class:"fas fa-chevron-left"},null,-1),ze=[Se],Ae=a("i",{class:"fas fa-chevron-right"},null,-1),De=[Ae],Ne={key:1,class:"deals-list__skeleton-body tw-h-full md:tw-pt-3"},Re=a("div",{class:"icon size-80"},[a("i",{class:"fas fa-funnel-dollar"})],-1),Qe=M({__name:"DealsListTable",props:{deals:{},useColumnsIds:{},isFetching:{type:Boolean},navigateRouteName:{},tileView:{type:Boolean}},setup(y){const e=y,l=R(null),p=R(!1),c=F(le),{x:r,arrivedState:_}=j(l,{throttle:200}),b=u(()=>!c.value&&p.value&&!_.right);U(l,i=>{const n=i[0];p.value=n.target.scrollWidth>n.target.clientWidth}),Y(()=>e.isFetching,i=>{if(!i){const n=l.value;n&&(p.value=n.scrollWidth>n.clientWidth)}},{debounce:500});function f(i){var N;const $=Array.from(((N=l.value)==null?void 0:N.querySelectorAll(".deal-list__row:last-of-type > *"))||[]),d=$.map(h=>h.offsetLeft),k=$.length-1,D=d[k]+350,I=$[k].offsetWidth;if(I>D){let h=D;for(;h<I;)d.push(h),h+=350;d.push(I)}const W=i==="next"?d.find(h=>h>r.value+1):d.reverse().find(h=>h<r.value-1);r.value=W??d[2]}const A={checkbox:"minmax(40px, 40px)",stage_id:"minmax(230px, 2fr)",name:"minmax(240px, 2fr)",states:"minmax(100px, 0.5fr)",create_datetime:"minmax(135px, 1fr)",amount:"minmax(150px, 1fr)",tags:"minmax(180px, 1.33fr)",user_name:"minmax(250px, 2fr)",last_action:"minmax(auto, 100%)"},C=u(()=>{let i="";return e.useColumnsIds.forEach(n=>{i+=A[n]+" "}),i});return(i,n)=>{const $=H("RouterLink");return s(),t("div",Ie,[a("div",{class:g(["deals-list",{"deals-list--mobile":m(c),"deals-list--tiles":!m(c)&&e.tileView,"refresh-list":e.deals.length&&e.isFetching}])},[i.deals.length?(s(),t("div",{key:0,ref_key:"scrollableContainerRef",ref:l,class:g(["deals-list__table-wrapper",{"overflow-soft-hide-x":b.value}])},[a("div",{class:"deals-list__table",style:P({"--deals-list-row-grid-template-columns":C.value})},[!e.tileView&&!m(c)?(s(),t(L,{key:0},[a("div",{class:g([{"tw-hidden":!p.value},"tw-absolute tw-top-1 tw-left-0 tw-w-full tw-z-30"])},[z(a("div",{class:g([{"tw-opacity-30":m(_).left},"col-nav col-nav--left tw-left-0"]),onClick:n[0]||(n[0]=V(d=>f("prev"),["prevent"]))},ze,2),[[E,!m(_).left]]),a("div",{class:g([{"tw-opacity-30":m(_).right},"col-nav col-nav--right tw-right-0"]),onClick:n[1]||(n[1]=V(d=>f("next"),["prevent"]))},De,2)],2),T(i.$slots,"headers",{useColumnsIds:i.useColumnsIds})],64)):o("",!0),(s(!0),t(L,null,Q(e.deals,d=>(s(),x($,{key:d.id,to:{name:e.navigateRouteName||"deal",params:{id:d.id}},custom:""},{default:B(({navigate:k})=>[T(i.$slots,"listItem",{deal:d,isMobile:!!m(c),useColumnsIds:i.useColumnsIds,navigate:k},()=>[v(Me,{deal:d,"use-columns-ids":i.useColumnsIds,"is-mobile":!!m(c),"is-tile-view":!m(c)&&e.tileView,onClick:k},null,8,["deal","use-columns-ids","is-mobile","is-tile-view","onClick"])])]),_:2},1032,["to"]))),128))],4),T(i.$slots,"lazy")],2)):o("",!0),e.isFetching?(s(),t("div",Ne,[v(ie,{"row-height":m(c)?"108px":"38px"},null,8,["row-height"])])):o("",!0),e.deals.length===0&&!e.isFetching?(s(),x(ae,{key:2,message:i.$t("noDeals")},{default:B(()=>[Re]),_:1},8,["message"])):o("",!0)],2)])}}});export{Qe as _,Me as a};
