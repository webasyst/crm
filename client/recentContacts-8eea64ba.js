import{a7 as C,O as r,h as c,aA as F,L as R,R as _}from"./main-d7f03521.js";const j=C("recentContacts",()=>{const{data:p,isFetching:f,error:l,isFinished:m,canAbort:v,abort:h,execute:x}=r("crm.contact.recent",{immediate:!1}).get().json(),a=c(new Set),n=c([]),s=c([]),u=F(R(),"contact");_(p,e=>{e&&"pinned"in e&&(n.value=e.pinned,s.value=e.recent)});function b(){v.value&&h(),setTimeout(()=>{x()})}async function I(e,i){var o,d;const{id:t}=e;a.value.add(t);const{response:g}=await r(`crm.contact.${i?"pin":"unpin"}`).post({id:t});(o=g.value)!=null&&o.ok&&((i?s:n).value.splice((i?s:n).value.findIndex(w=>w.id===t),1),((d=u.value)==null?void 0:d.id)===t&&(u.value.is_pinned=i),i&&("main"in e?n.value.push({id:t,name:e.main.name,userpic:e.userpic.thumb}):n.value.push(e))),a.value.delete(t)}function S(e){(e.is_pinned?n:s).value.findIndex(i=>i.id===e.id)===-1&&(e.is_pinned?n:s).value.push({id:e.id,name:e.main.name,userpic:e.userpic.thumb})}return{pinned:n,recent:s,isFetching:f,isFinished:m,error:l,fetchingIds:a,addIfNotExists:S,refetch:b,pin:I}});export{j as u};
