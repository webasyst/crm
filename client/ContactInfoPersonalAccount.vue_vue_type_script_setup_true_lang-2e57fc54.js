import{d as C,a as w,U as y,o,b as v,w as $,e as N,g as m,L as A,i as n,c as i,m as _,k as r,F as h,p as B,f as F,B as k,R as I}from"./main-49799bbb.js";import{C as S}from"./CustomField-11c9ecf8.js";import{B as V}from"./ButtonSubmit-f807b130.js";import{T}from"./TextAreaAutoresize-e338c58d.js";import{_ as L}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-a48aca33.js";const P=C({__name:"FormConfirmBanPersonalAccount",props:{contactId:{},contactName:{},onSuccess:{type:Function}},emits:["close"],setup(b,{emit:t}){const a=b,s=w(""),u=y("crm.contact.ban",{immediate:!1}),{response:p,isFetching:e,error:d}=u,c=async()=>{var l;await u.post({id:a.contactId,reason:s.value.trim()}).execute(),(l=p.value)!=null&&l.ok&&p.value.status===204&&(a.onSuccess(),t("close"))};return(l,f)=>(o(),v(L,{message:`${l.$t("banContact")} ${a.contactName}`,"submit-button-name":l.$t("ban"),"is-loading":m(e),error:m(d),"on-confirm":c,onClose:f[1]||(f[1]=g=>t("close"))},{default:$(()=>[N(T,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g),placeholder:l.$t("optionalCommentBan"),"min-rows":3,"max-rows":10},null,8,["modelValue","placeholder"])]),_:1},8,["message","submit-button-name","is-loading","error"]))}}),U={class:"personal-account tw-flex tw-items-center tw-gap-3"},M={class:"personal-account__status tw-text-sm"},z={key:0,class:"personal-account__action"},x=n("span",null,[n("i",{class:"fas fa-circle text-green custom-mr-4"})],-1),D=["onClick"],E=n("span",null,[n("i",{class:"fas fa-ban text-red custom-mr-4"})],-1),J=C({__name:"ContactInfoPersonalAccount",props:{contactId:{},contactName:{},hasLogin:{type:Boolean},hasPassword:{type:Boolean},isBanned:{type:Boolean}},setup(b){const t=b,{contact:a}=A(),s=w(!1);function u(){I(P,{contactId:t.contactId,contactName:t.contactName,onSuccess:()=>{a&&(a.details.is_banned=!0)}}).show()}async function p(){var c;s.value=!0;const{response:e,execute:d}=y("crm.contact.unban",{immediate:!1}).post({id:t.contactId});await d(),(c=e.value)!=null&&c.ok&&e.value.status===204&&a&&(a.details.is_banned=!1),s.value=!1}return(e,d)=>(o(),v(S,{label:e.$t("personalAccount"),"tooltip-content":e.$t("personalAccountTooltipMessage",[m(k).backendUrl?`<a href='${m(k).backendUrl}site/#/personal/settings/' class='semibold'>${e.$t("personalAccountTooltipLinkName")}</a>`:e.$t("personalAccountTooltipLinkName")]),"tooltip-placement":"top-end"},{default:$(()=>{var c;return[n("div",U,[n("div",M,[t.isBanned?(o(),i(h,{key:0},[_(r(e.$t("banned")),1)],64)):t.hasPassword?(o(),i(h,{key:1},[_(r(e.$t("available")),1)],64)):(o(),i(h,{key:2},[_(r(e.$t("notAvailable")),1)],64))]),(c=m(k).rights)!=null&&c.is_admin&&!t.hasLogin?(o(),i("div",z,[t.isBanned?(o(),v(V,{key:0,"type-link":!0,"is-fetching":s.value,size:"small",onClick:B(p,["prevent"])},{default:$(()=>[x,n("span",null,r(e.$t("removeBan")),1)]),_:1},8,["is-fetching","onClick"])):(o(),i("a",{key:1,class:"nowrap semibold small",onClick:B(u,["prevent"])},[E,n("span",null,r(e.$t("ban")),1)],8,D))])):F("",!0)])]}),_:1},8,["label","tooltip-content"]))}});export{J as _};
