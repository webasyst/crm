import{Z as A,$ as O,I as Q,u as W,a as y,P as N,d as U,y as j,C as L,o as b,b as $,w as n,m as v,k as l,i as s,p as q,e as h,W as D,Q as z,A as Z,V as G,g as w,f as J,c as K,F as X,l as Y,n as _,R as ee}from"./main-07d84941.js";import{C as B}from"./CustomColumn-36c752a1.js";import{F as te}from"./FieldString-83da0a5f.js";import{_ as M}from"./FieldCheckbox-eb6fe774.js";import{_ as ae}from"./InputWithContacts.vue_vue_type_script_setup_true_lang-4ab9d7cb.js";import{u as se}from"./validation-46e41ea1.js";const Ve=A("sidebar",()=>{const f=O(),d=Q("(min-width: 1024px)"),e=W("show-sidebar",!1),u=y(d.value?e.value:!1);return f.redirectedFrom||(u.value=!1),N(()=>f.fullPath,()=>{u.value=!1}),N(u,m=>{document.documentElement.classList[m?"add":"remove"]("sidebarOpened"),d.value&&(e.value=m)},{immediate:!0}),{showSidebar:u}}),oe=["disabled","onClick"],ne=U({__name:"FormContactsAddToSegment",props:{segment:{}},emits:["close"],setup(f,{emit:d}){const e=f,u=j(),m=L(),a=y([]),c=y();async function S(){a.value.length&&(c.value=m.includeContactsToSegment(e.segment.id,a.value.map(g=>g.id)),await c.value.execute(),c.value.error||(u.updateFetchParams(),d("close")))}return(g,p)=>(b(),$(D,{"use-cancel-as-button-label":!0,onClose:p[1]||(p[1]=i=>d("close"))},{header:n(()=>[v(l(g.$t("addContactsToSegment"))+" '"+l(e.segment.name)+"' ",1)]),submit:n(()=>{var i;return[s("button",{class:"button",disabled:!!((i=c.value)!=null&&i.isFetching)||!a.value.length,onClick:q(S,["prevent"])},l(g.$t("save")),9,oe)]}),error:n(()=>{var i;return[v(l((i=c.value)==null?void 0:i.error),1)]}),default:n(()=>[h(ae,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=i=>a.value=i)},null,8,["modelValue"])]),_:1}))}}),le=["disabled"],ie={class:"tw-flex tw-space-x-2"},re={class:"tw-flex-none tw-w-32 small gray tw-break-words"},de=s("i",{class:"fas fa-user-friends"},null,-1),ue={class:"hint"},ce=s("i",{class:"fas fa-filter"},null,-1),me={class:"hint"},pe={class:"tw-flex tw-space-x-2"},fe={class:"tw-flex-none tw-w-32 small gray tw-break-words"},ge={class:"tw-flex tw-flex-wrap"},he=["onClick"],ve={class:"tw-flex tw-space-x-2"},we={class:"tw-flex-none tw-w-32 small gray tw-break-words"},Fe=U({__name:"FormSegmentUpdate",props:{initialShared:{},initialType:{},initialName:{},initialHash:{},segment:{}},emits:["close"],setup(f,{emit:d}){var k,C,V,F,x,T;const e=f,u=["user-friends","search","user","folder","file","lock","lock-open","brush","star","pencil-alt","bolt","lightbulb","images","chart-bar","book","map-marker-alt","camera","hourglass-end","cat","anchor","seedling","car-alt","save","cookie","radiation-alt","film","bug","clock","coffee","home","apple-alt","briefcase","guitar","smile","futbol","bullseye","award","phone-alt","store","shopping-cart","pen-alt","life-ring","columns"],m=z(),a=y({name:((k=e.segment)==null?void 0:k.name)??e.initialName??"",type:((C=e.segment)==null?void 0:C.type)??e.initialType??"category",icon:((V=e.segment)==null?void 0:V.icon)??"",shared:(F=e.segment)!=null&&F.shared?"1":e.initialShared??"0",hash:((x=e.segment)==null?void 0:x.hash)??e.initialHash??""}),{validation:c,validate:S}=se(a,{name:"required"}),g=Z(()=>{if(e.segment){const{type:t,hash:r,...o}=a.value;return o}return a.value}),p=L(),{data:i,isFetching:H,error:E,execute:I}=p[e.segment?"updateSegment":"addSegment"](g,(T=e.segment)==null?void 0:T.id);e.initialHash||G(()=>{a.value.hash=a.value.type==="search"?"crmSearch/":""});async function P(){if(S()&&await I()&&(d("close"),!e.segment)){m.push({name:"segment",params:{id:i.value.id}});const t=p.getSegmentById(i.value.id);(t==null?void 0:t.type)==="category"&&ee(ne,{segment:t}).show(),(t==null?void 0:t.type)==="search"&&m.push({name:e.initialHash?"segment":"updateSegmentFilter",params:{id:t.id}})}}return(t,r)=>(b(),$(D,{onClose:r[3]||(r[3]=o=>d("close"))},{header:n(()=>[v(l(t.$t(`${e.segment?"update":"create"}Segment`)),1)]),submit:n(()=>[s("button",{class:"button",disabled:w(H),onClick:P},l(t.$t(e.segment?"update":"create")),9,le)]),error:n(()=>[v(l(w(E)),1)]),default:n(()=>[h(B,{space:"6"},{default:n(()=>[s("div",ie,[s("div",re,l(t.$t("name")),1),s("div",null,[h(B,{space:"2"},{default:n(()=>[h(te,{modelValue:a.value.name,"onUpdate:modelValue":r[0]||(r[0]=o=>a.value.name=o),type:"text",error:w(c).name.error,"error-message":w(c).name.errorMessage},null,8,["modelValue","error","error-message"]),e.segment?J("",!0):(b(),$(M,{key:0,modelValue:a.value.type,"onUpdate:modelValue":r[1]||(r[1]=o=>a.value.type=o),vertical:!0,disabled:!!e.initialType,options:[{id:"category",value:t.$t("staticList")},{id:"search",value:t.$t("dynamicFilter")}]},{category:n(()=>[de,v("Â "),s("span",ue,l(t.$t("staticListDesc")),1)]),search:n(()=>[ce,s("span",me,l(t.$t("dynamicFilterDesc")),1)]),_:1},8,["modelValue","disabled","options"]))]),_:1})])]),s("div",pe,[s("div",fe,l(t.$t("icon")),1),s("div",null,[s("div",ge,[(b(),K(X,null,Y(u,(o,R)=>s("div",{key:R,class:_(["tw-w-10 tw-h-10 tw-mr-1 tw-mb-1 tw-flex tw-items-center tw-justify-center tw-rounded-full tw-overflow-hidden tw-cursor-pointer",{"tw-bg-waBackground":a.value.icon===o}]),onClick:be=>a.value.icon=o},[s("span",{class:_(["icon tw-opacity-50",{"tw-opacity-100":a.value.icon===o}])},[s("i",{class:_(`fas fa-${o}`)},null,2)],2)],10,he)),64))])])]),s("div",ve,[s("div",we,l(t.$t("permission")),1),s("div",null,[h(M,{modelValue:a.value.shared,"onUpdate:modelValue":r[2]||(r[2]=o=>a.value.shared=o),vertical:!0,options:[{id:"0",value:t.$t("onlyMe")},{id:"1",value:t.$t("allUsers")}]},null,8,["modelValue","options"])])])]),_:1})]),_:1}))}});export{Fe as _,ne as a,Ve as u};
