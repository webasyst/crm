import{U as i}from"./UserPic-2094e1a0.js";import{a as f}from"./InputWithUsers.vue_vue_type_script_setup_true_lang-e9424cff.js";import{d as h,a as v,af as V,o as w,b as x,w as c,i as a,e as u,k as r,g as m,M as y}from"./main-512a5cdd.js";const I={class:"icon size-20"},$=["title"],C={class:"tw-flex tw-items-center tw-space-x-2"},B={class:"icon size-20"},F=["title"],g=h({__name:"InputWithContacts",props:{modelValue:{default:()=>[]},isMultiple:{type:Boolean,default:!0},isCompany:{type:Boolean},textValue:{},onEnter:{},onItemSelect:{}},emits:["update:modelValue"],setup(p,{emit:d}){const t=p,o=v([]),l=V(async s=>{const n=s.includes("@")?"email":/^[+\-0-9() ]+$/.test(s)?"phone":"name.name",{data:e}=await y(`crm.contact.list?hash=crmSearch/contact_info.${n}*=${encodeURIComponent(`${s}${t.isCompany?"&contact_info.contact_type.company=1":""}`)}&limit=10`).get().json();e.value&&(o.value=e.value.data)},300);return(s,n)=>(w(),x(f,{items:o.value.filter(e=>!t.modelValue.map(_=>_.id).includes(e.id)),value:t.modelValue,"text-value":t.textValue,"is-multiple":t.isMultiple,placeholder:s.$t("search"),"on-enter":t.onEnter,"on-item-select":t.onItemSelect,onInput:m(l),onFocus:m(l),onUpdate:n[0]||(n[0]=e=>{d("update:modelValue",e)})},{item:c(({item:e})=>[a("div",I,[u(i,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate",title:e.name},r(e.name),9,$)]),listItem:c(({item:e})=>[a("div",C,[a("div",B,[u(i,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate small",title:e.name},r(e.name),9,F)])]),_:1},8,["items","value","text-value","is-multiple","placeholder","on-enter","on-item-select","onInput","onFocus"]))}});export{g as _};
