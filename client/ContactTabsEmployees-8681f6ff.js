import{d as E,a as c,A as r,z as k,M as L,P as N,g as i,o as l,b as u,c as b,k as z,w as m,e as V,h as M,f as x,i as f,$ as O}from"./main-ad3d4b2a.js";import{v as T}from"./index-f0757591.js";import{E as U}from"./EmptyList-a90c3660.js";import{C as j,_ as A}from"./ContactsListItems-3069d7eb.js";import{S as q}from"./SkeletonList-22bbddc4.js";import"./CustomColumn-d0d2dfb9.js";import"./index-38eb481c.js";import"./UserPic-e76d468d.js";import"./ChipsList-007889bd.js";import"./ContactsListItemAction.vue_vue_type_style_index_0_lang-70395f49.js";import"./dayjs-e01b34a2.js";import"./vTooltip-c8fe82a0.js";const G={key:1,class:"state-error tw-p-4"},H=f("div",{class:"icon size-80"},[f("i",{class:"fas fa-user-friends"})],-1),J={key:0,class:"tw-text-center tw-py-4"},K=f("div",{class:"spinner custom-p-16"},null,-1),Q=[K],C=30,nt=E({__name:"ContactTabsEmployees",props:{contactId:{}},setup(I){var v,h,_;const P=I,e=c([]),a=c(null),n=c(null),s=c(0),o=c({fields:(v=r.contact_list_columns)==null?void 0:v.map(t=>t.field),hash:`crmSearch/contact_info.company_contact_id=${P.contactId}`,sort:(h=r.contact_list_sort)==null?void 0:h.field,asc:(_=r.contact_list_sort)!=null&&_.asc?1:0,limit:C}),B=k(()=>`crm.contact.list?${O.stringify(o.value)}`),F=k(()=>{var t;return(((t=a.value)==null?void 0:t.columns)||[]).filter(w=>w.id!=="name")}),{data:S,isFetching:d}=L(B,{immediate:!0,refetch:!0}).get().json();N(S,async t=>{n.value=null,t&&(a.value&&t.params.offset>s.value?(e.value=[...e.value,...t.data],s.value=t.params.offset):(e.value=t.data,s.value=t.params.offset),a.value=t.params)});function p(t){a.value&&(o.value={...o.value,offset:0,...t,_:Date.now()})}function $(){p({offset:s.value+C})}return(t,w)=>i(d)&&!o.value.offset?(l(),u(q,{key:0,class:"box","row-height":"32px"})):n.value?(l(),b("div",G,z(n.value),1)):e.value.length?e.value.length&&a.value?(l(),u(A,{key:3,breakpoint:["md"],"trigger-class":["tw-group/md-contacts"],class:"tw-absolute tw-w-full tw-h-full tw-flex tw-flex-col tw-bg-waBlank"},{default:m(()=>[V(j,{contacts:e.value,"header-columns":F.value,"fetch-params":o.value,sort:a.value.sort,"disable-sync-settings":!0,onUpdateFetchParams:p},{lazyloadDown:m(()=>{var g,y;return[s.value+(((g=a.value)==null?void 0:g.limit)??0)<(((y=a.value)==null?void 0:y.total_count)??0)?M((l(),b("div",J,Q)),[[i(T),([{isIntersecting:D}])=>{D&&!i(d)&&$()}]]):x("",!0)]}),_:1},8,["contacts","header-columns","fetch-params","sort"])]),_:1})):x("",!0):(l(),u(U,{key:2,message:t.$t("noContacts")},{default:m(()=>[H]),_:1},8,["message"]))}});export{nt as default};
