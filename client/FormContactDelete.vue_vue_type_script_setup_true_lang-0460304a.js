import{d as C,o as t,b as $,c as a,k as e,r as B,H as D,x as L,M,$ as N,a2 as y,g as s,w as h,m as i,i as c,F as l,p as W,e as _,f as x,l as f}from"./main-512a5cdd.js";import{U as I}from"./UserPic-2094e1a0.js";import{W as V}from"./WaSpinner-c8c65e65.js";import{W as P}from"./WaDialog-079c5577.js";const R={key:1},j=C({__name:"WaDialogLoading",props:{isFetching:{type:Boolean},error:{}},setup(m){const d=m;return(r,g)=>d.isFetching?(t(),$(V,{key:0})):d.error?(t(),a("div",R,e(r.error),1)):B(r.$slots,"default",{key:2})}}),U=["disabled","onClick"],z={key:0},A={class:"text-orange"},E={class:"tw-flex tw-flex-auto tw-w-1/2 tw-space-x-2 tw-items-center"},H={class:"tw-truncate"},T={class:"tw-flex-none"},q={class:"tw-whitespace-nowrap"},X=C({__name:"FormContactDelete",props:{contactIds:{},disableContactsPageRedirect:{type:Boolean}},emits:["close"],setup(m,{emit:d}){const r=m,g=D(),u=L().deleteContacts(r.contactIds),o=M(`crm.contact.links?${N.stringify({id:r.contactIds})}`).get().json();async function b(){if(o.error.value){o.execute();return}await u.execute()&&(d("close"),r.disableContactsPageRedirect||g.push({name:"contacts"}))}return(n,k)=>(t(),$(P,{onClose:k[0]||(k[0]=p=>d("close"))},y({header:h(()=>[i(e(n.$t("deleteContacts",r.contactIds.length)),1)]),submit:h(()=>[c("button",{disabled:s(o).isFetching.value||s(u).isFetching.value,onClick:W(b,["prevent"])},[s(o).isFetching.value?(t(),a(l,{key:0},[i(e(n.$t("checkingLinks")),1)],64)):s(o).error.value?(t(),a(l,{key:1},[i(e(n.$t("recheckLinks")),1)],64)):s(u).isFetching.value?(t(),a(l,{key:2},[i(e(n.$t("deleting")),1)],64)):(t(),a(l,{key:3},[i(e(n.$t("deleteAnyway")),1)],64))],8,U)]),default:h(()=>[_(j,{"is-fetching":s(o).isFetching.value,error:s(o).error.value},y({_:2},[s(o).data.value&&"linked_contacts"in s(o).data.value?{name:"default",fn:h(()=>[c("p",null,e(n.$t("deleteContactsMessage1")),1),s(o).data.value.linked_contacts.length?(t(),a("p",z,[c("strong",A,e(n.$t("importantNote")),1),i(" "+e(n.$t("deleteContactsMessage2"))+" "+e(n.$t("deleteContactsMessage3")),1)])):x("",!0),(t(!0),a(l,null,f(s(o).data.value.linked_contacts,p=>(t(),a("div",{key:p.id},[(t(!0),a(l,null,f(p.links,(v,F)=>(t(),a("div",{key:F},[(t(!0),a(l,null,f(v.roles,(w,S)=>(t(),a("div",{key:S,class:"tw-flex tw-space-x-2 tw-justify-between tw-py-1 bordered-bottom tw-text-sm"},[c("div",E,[_(I,{url:p.userpic,size:16},null,8,["url"]),c("div",H,e(p.name),1),c("div",T,e(v.app)+"/"+e(w.role),1)]),c("div",q,e(n.$t("links",w.count)),1)]))),128))]))),128))]))),128))]),key:"0"}:void 0]),1032,["is-fetching","error"])]),_:2},[s(u).isFetching.value?void 0:{name:"error",fn:h(()=>[i(e(s(u).error.value),1)]),key:"0"}]),1024))}});export{j as _,X as a};
