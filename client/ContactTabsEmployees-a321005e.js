import{d as E,a as c,A as r,z as g,W as L,J as z,N as V,g as i,o as l,b as k,c as u,k as $,w as x,e as O,h as T,f as b,i as m}from"./main-ec0df6a4.js";import{v as U}from"./index-8d873219.js";import{E as j}from"./EmptyList-9d13a159.js";import{C as A}from"./ContactsListItems-80e6e8c7.js";import{S as J}from"./SkeletonList-192ed29f.js";import"./CustomColumn-959e6ffe.js";import"./UserPic-87c13a4a.js";import"./ChipsList-64240846.js";import"./ContactsListItemAction.vue_vue_type_script_setup_true_lang-37a8a184.js";import"./dayjs-44a66bd3.js";import"./vTooltip-c8fe82a0.js";const M={key:1,class:"state-error tw-p-4"},W=m("div",{class:"icon size-80"},[m("i",{class:"fas fa-user-friends"})],-1),q={key:3,class:"tw-@container/contacts tw-absolute tw-w-full tw-h-full tw-flex tw-flex-col tw-bg-waBlank"},G={key:0,class:"tw-text-center tw-py-4"},H=m("div",{class:"spinner custom-p-16"},null,-1),K=[H],C=30,lt=E({__name:"ContactTabsEmployees",props:{contactId:{}},setup(I){var v,p,h;const B=I,a=c([]),e=c(null),n=c(null),s=c(0),o=c({fields:(v=r.contact_list_columns)==null?void 0:v.map(t=>t.field),hash:`crmSearch/contact_info.company_contact_id=${B.contactId}`,sort:(p=r.contact_list_sort)==null?void 0:p.field,asc:(h=r.contact_list_sort)!=null&&h.asc?1:0,limit:C}),F=g(()=>`crm.contact.list?${L.stringify(o.value)}`),N=g(()=>{var t;return(((t=e.value)==null?void 0:t.columns)||[]).filter(_=>_.id!=="name")}),{data:P,isFetching:f}=z(F,{immediate:!0,refetch:!0}).get().json();V(P,async t=>{n.value=null,t&&(e.value&&t.params.offset>s.value?(a.value=[...a.value,...t.data],s.value=t.params.offset):(a.value=t.data,s.value=t.params.offset),e.value=t.params)});function d(t){e.value&&(o.value={...o.value,offset:0,...t,_:Date.now()})}function S(){d({offset:s.value+C})}return(t,_)=>i(f)&&!o.value.offset?(l(),k(J,{key:0,class:"box","row-height":"32px"})):n.value?(l(),u("div",M,$(n.value),1)):a.value.length?a.value.length&&e.value?(l(),u("div",q,[O(A,{contacts:a.value,"header-columns":N.value,"fetch-params":o.value,sort:e.value.sort,"disable-sync-settings":!0,onUpdateFetchParams:d},{lazyloadDown:x(()=>{var w,y;return[s.value+(((w=e.value)==null?void 0:w.limit)??0)<(((y=e.value)==null?void 0:y.total_count)??0)?T((l(),u("div",G,K)),[[i(U),([{isIntersecting:D}])=>{D&&!i(f)&&S()}]]):b("",!0)]}),_:1},8,["contacts","header-columns","fetch-params","sort"])])):b("",!0):(l(),k(j,{key:2,message:t.$t("noContacts")},{default:x(()=>[W]),_:1},8,["message"]))}});export{lt as default};
