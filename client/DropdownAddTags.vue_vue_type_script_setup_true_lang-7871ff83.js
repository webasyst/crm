import{d as w,a as h,z as C,o as a,b as c,w as p,i as l,k as m,g as d,c as u,m as T,F as f,l as F,f as y,a8 as b,p as x}from"./main-512a5cdd.js";import{u as S}from"./tags-ec5b68fa.js";import{C as A}from"./CustomColumn-351ad915.js";import{C as B,a as L}from"./ChipsList-784e50f6.js";import{F as I}from"./FieldString-0d7a3814.js";const z={class:"hint"},D={key:0},E=l("div",{class:"spinner"},null,-1),K=[E],M=["onClick"],$={key:0},N=l("i",{class:"fas fa-spinner tw-animate-spin"},null,-1),U=[N],j={key:1},q=l("i",{class:"fas fa-hashtag"},null,-1),G=[q],H={class:"tw-flex-auto tw-truncate"},J={class:"count tw-mt-0.5"},X=w({__name:"DropdownAddTags",props:{modelValue:{},entityType:{},entityIds:{}},emits:["update:modelValue"],setup(g,{emit:v}){const n=g,o=S();o.refetch();const i=h(""),r=h(new Set),V=C(()=>o.tags.filter(e=>!("tags"in n.modelValue?n.modelValue.tags:n.modelValue).map(t=>typeof t=="string"?t:t.name).includes(e.name)).sort((e,t)=>t.count-e.count).slice(0,10));function k(e){_(i.value),i.value="",e.target.blur()}async function _(e){Array.isArray(n.modelValue)?v("update:modelValue",[...n.modelValue,e]):(r.value.add(e),await o.tagAssign(n.entityType,n.entityIds,[e]).execute(),r.value.delete(e))}return(e,t)=>(a(),c(A,{space:"2"},{default:p(()=>[l("div",z,m(e.$t("popularTags")),1),d(o).isFetching?(a(),u("div",D,K)):d(o).error?(a(),u(f,{key:1},[T(m(d(o).error),1)],64)):d(o).tags.length?(a(),c(B,{key:2},{default:p(()=>[(a(!0),u(f,null,F(V.value,s=>(a(),c(L,{key:s.id,class:"smaller"},{default:p(()=>[l("a",{onClick:x(()=>{!r.value.has(s.name)&&_(s.name)},["prevent"])},[r.value.has(s.name)?(a(),u("span",$,U)):(a(),u("span",j,G)),l("span",H,m(s.name),1),l("span",J,m(s.count),1)],8,M)]),_:2},1024))),128))]),_:1})):y("",!0),d(o).isFetching?y("",!0):(a(),c(I,{key:3,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),modelModifiers:{trim:!0},disabled:r.value.size,type:"text",placeholder:e.$t("createNewTag"),onKeyup:t[1]||(t[1]=b(s=>{i.value.length&&k(s)},["enter"]))},null,8,["modelValue","disabled","placeholder"]))]),_:1}))}});export{X as _};
