import{_ as oe}from"./ViewWithSidebar.vue_vue_type_style_index_0_lang-6ed39417.js";import{_ as T,o as e,c as n,r as F,d as C,u as ae,a as U,b as f,w as l,e as u,f as y,n as I,g as a,h as j,v as ie,i as t,t as S,j as V,k as m,F as g,l as R,m as M,p as N,q,s as E,x as ce,y as G,z as J,A,B as re,C as le,D as _e}from"./main-ad3d4b2a.js";import{u as de}from"./recentContacts-6dcec390.js";import{U as L}from"./UserPic-e76d468d.js";import{M as Q,_ as W}from"./MenuList-d27c7173.js";import{C as D}from"./CustomColumn-d0d2dfb9.js";import{e as ue}from"./helpers-c0c14d27.js";import{u as pe,_ as me}from"./FormSegmentUpdate.vue_vue_type_script_setup_true_lang-de3b66c1.js";import{_ as fe}from"./InputWithContacts.vue_vue_type_script_setup_true_lang-05c199be.js";import{_ as X}from"./WaDialogOpener.vue_vue_type_script_setup_true_lang-55644d30.js";import{_ as he,u as $e}from"./FormContactUpdate.vue_vue_type_script_setup_true_lang-1cf5407d.js";import{u as ge}from"./tags-66e0142b.js";import{v as ye}from"./vTooltip-c8fe82a0.js";import{_ as ke}from"./TagsCloud.vue_vue_type_script_setup_true_lang-fe2c5a56.js";import"./FieldString-77b19497.js";import"./FieldCheckbox-ea76a60e.js";import"./WaDialog-48ef549a.js";import"./validation-32ee062c.js";import"./InputWithUsers.vue_vue_type_script_setup_true_lang-fe28f2e3.js";import"./DropDown-6640089d.js";import"./index-f0757591.js";import"./SortableList.vue_vue_type_script_setup_true_lang-bcf551ed.js";import"./useSortable-1dcfe543.js";import"./FieldSelect-fbb8732d.js";import"./fields-00e92370.js";import"./dialog-55612c15.js";import"./funnels-5e77cb0b.js";import"./ChipsList-007889bd.js";import"./emit-32ce2ce5.js";const ve={},Se={class:"heading"};function Ce(d,o){return e(),n("div",Se,[F(d.$slots,"default",{},void 0,!0)])}const we=T(ve,[["render",Ce],["__scopeId","data-v-e4f563ea"]]),be={key:0,class:"caret tw-w-3 tw-flex-none"},xe=t("i",{class:"fas fa-caret-right"},null,-1),Re=[xe],Y=C({__name:"AccordionSidebar",props:{showCaret:{type:Boolean},openOnInitial:{type:Boolean},disabled:{type:Boolean},storageKey:{}},setup(d){const o=d,i=o.storageKey?ae(`sidebar-accordions-${o.storageKey}`,o.openOnInitial):U(o.openOnInitial);return(_,s)=>(e(),f(D,{space:"2"},{default:l(()=>[u(we,{class:I({open:a(i)}),onClick:s[0]||(s[0]=()=>{o.disabled||(i.value=!a(i))})},{default:l(()=>[o.showCaret?(e(),n("span",be,Re)):y("",!0),F(_.$slots,"header")]),_:3},8,["class"]),j(t("div",null,[F(_.$slots,"default")],512),[[ie,a(i)]])]),_:3}))}});const P=d=>(q("data-v-9a18827c"),d=d(),E(),d),Ie={class:"tw-px-4"},Be={key:0,class:"skeleton"},Le={key:0,class:"tw-pl-4 small gray"},Ne=["title"],Ve=["onClick"],ze={key:0},Ae=P(()=>t("i",{class:"fas fa-spinner text-yellow tw-animate-spin"},null,-1)),Fe=[Ae],Me={key:1},Te=P(()=>t("i",{class:"fas fa-star text-yellow"},null,-1)),De=[Te],Pe={key:2},Ke=P(()=>t("i",{class:"far fa-star text-light-gray"},null,-1)),Oe=[Ke],He=C({__name:"ContactsSidebarRecent",setup(d){const o=de(),{pinned:i,recent:_,isFetching:s,error:c,fetchingIds:k,pin:v}=S(o);return o.refetch(),($,K)=>{const B=V("RouterLink");return e(),f(Y,{"show-caret":!0,"open-on-initial":!0,"storage-key":"recent"},{header:l(()=>[t("span",null,m($.$t("recentContacts")),1)]),default:l(()=>[t("div",Ie,[a(s)?(e(),n("div",Be,[(e(),n(g,null,R(8,x=>t("div",{ref_for:!0,ref:"lineRef",key:x,class:"skeleton-line"})),64))])):a(c)?(e(),n(g,{key:1},[M(m(a(c)),1)],64)):(e(),n(g,{key:2},[![...a(i),...a(_)].length&&!a(s)?(e(),n("div",Le,m($.$t("emptyList")),1)):y("",!0),u(Q,null,{default:l(()=>[(e(!0),n(g,null,R([a(i),a(_)],(x,w)=>(e(),n(g,{key:w},[(e(!0),n(g,null,R(x,h=>(e(),f(W,{key:h.id,class:"rounded selected"},{default:l(()=>[u(B,{to:{name:"contact",params:{id:h.id}},class:I($.$constant.parentAppDisableRouterClass)},{default:l(()=>[u(L,{url:h.userpic,size:20},null,8,["url"]),t("div",{class:"tw-flex-auto tw-truncate",title:h.name},m(h.name),9,Ne),t("span",{class:"count",onClick:N(O=>a(v)(h.id,!!w),["stop","prevent"])},[a(k).has(h.id)?(e(),n("span",ze,Fe)):y("",!0),!a(k).has(h.id)&&w===0?(e(),n("span",Me,De)):y("",!0),!a(k).has(h.id)&&w===1?(e(),n("span",Pe,Oe)):y("",!0)],8,Ve)]),_:2},1032,["to","class"])]),_:2},1024))),128))],64))),128))]),_:1})],64))])]),_:1})}}});const Ue=T(He,[["__scopeId","data-v-9a18827c"]]),je={class:"tw-px-4"},qe={class:"tw-flex tw-space-x-2 tw-items-center tw-w-full"},Ee={class:"tw-flex-auto"},Ge=t("i",{class:"fas fa-filter gray"},null,-1),Je=[Ge],Qe={class:"tw-flex-none"},We=["onClick","onVnodeMounted"],Xe=t("i",{class:"fas fa-user-plus"},null,-1),Ye=[Xe],Ze={class:"tw-flex-none md:tw-hidden"},et=t("i",{class:"fas fa-sliders-h black"},null,-1),tt=[et],st=C({__name:"ContactsSidebarFilter",setup(d){const{showSidebar:o}=S(pe());function i(_,s){if(!s)return;s=ue(s);const c=s.includes("@")?"email":/^[+\-0-9() ]+$/.test(s)?"phone":"name.name";_.push({name:"search",params:{id:`contact_info.${c}*=${s}`}})}return(_,s)=>(e(),n("div",je,[t("div",qe,[t("div",Ee,[u(fe,{"on-enter":c=>i(_.$router,c),"on-item-select":c=>{_.$router.push({name:"contact",params:{id:c.id}})}},null,8,["on-enter","on-item-select"])]),t("div",{class:"tw-flex-none icon tw-cursor-pointer",onClick:s[0]||(s[0]=c=>_.$router.push({name:"detailedSearch"}))},Je),t("div",Qe,[u(X,{component:he},{default:l(({open:c})=>[t("button",{class:"circle",onClick:N(c,["prevent"]),onVnodeMounted:k=>_.$route.path==="/contact/new/"&&c()},Ye,8,We)]),_:1})]),t("div",Ze,[t("button",{class:"circle transparent",onClick:s[1]||(s[1]=N(c=>o.value=!a(o),["prevent"]))},tt)])])]))}}),nt=d=>(q("data-v-12cf976d"),d=d(),E(),d),ot={class:"bricks"},at=["onClick"],it={class:"icon"},ct=["src","alt"],rt={class:"count"},lt=["onClick"],_t=nt(()=>t("span",{class:"icon"},[t("i",{class:"fas fa-users"})],-1)),dt={class:"count"},ut=C({__name:"ContactsSidebarBricks",setup(d){const{allContactsTotal:o}=S(ce()),{responsibles:i}=S(G()),_=J(()=>{var s;return((s=i.value.find(c=>c.responsible.id===A.user.id))==null?void 0:s.count)??0});return(s,c)=>{const k=V("RouterLink");return e(),n("div",ot,[u(k,{to:{name:"myContacts"},custom:""},{default:l(({isExactActive:v,navigate:$})=>[t("div",{class:I(["brick",{selected:v}]),onClick:$},[t("span",it,[t("img",{src:a(A).user.userpic,alt:a(A).user.name,class:"userpic"},null,8,ct)]),t("span",rt,m(_.value),1),M(" "+m(s.$t("myContacts")),1)],10,at)]),_:1}),u(k,{to:{name:"contacts"},custom:""},{default:l(({isExactActive:v,navigate:$})=>[t("div",{class:I(["brick",{selected:v}]),onClick:$},[_t,t("span",dt,m(a(o)),1),M(" "+m(s.$t("allContacts")),1)],10,lt)]),_:1})])}}});const pt=T(ut,[["__scopeId","data-v-12cf976d"]]),mt={key:0,class:"count"},ft=["onClick"],ht=t("i",{class:"fas fa-plus-circle"},null,-1),$t=[ht],gt={key:0,class:"tw-mx-4"},yt={key:0,class:"tw-pl-4 small gray"},kt={key:0,class:"tw-pl-8 small gray"},vt=["href","onClick"],St={class:"count"},Ct={class:"tw-truncate"},H=C({__name:"ContactsSidebarSegments",props:{only:{},except:{}},setup(d){const o=d,{t:i}=re(),_=le(),{sharedSegment:s,archivedSegment:c,mySegment:k,isFetching:v}=S(_);_.refetch();const $=$e(),{vaults:K}=S($);$.refetch();const B=G(),{responsibles:x}=S(B);B.refetch();const w=J(()=>x.value.map(b=>({...b,...b.responsible}))),h=ge(),{tags:O}=S(h);h.refetch();const z=U([{id:"mySegment",name:i("mySegments"),items:k,loading:"segments",routeName:"segment",showPlus:!0},{id:"sharedSegment",name:i("sharedSegments"),items:s,loading:"segments",routeName:"segment",showPlus:!0},{id:"archivedSegment",name:i("archivedSegments"),items:c,loading:"segments",routeName:"segment",showCounter:!0},{id:"tags",name:i("tags"),items:O,loading:"tags",routeName:"tag"},{id:"vaults",name:i("vaults"),items:K,loading:"vaults",routeName:"vault"},{id:"responsibles",name:i("responsibles"),items:w,loading:"responsibles",routeName:"responsible"}]);return(b,bt)=>{const Z=V("RouterLink");return e(),f(D,{space:"4"},{default:l(()=>[(e(!0),n(g,null,R(o.only?z.value.filter(r=>r.id===o.only):o.except?z.value.filter(r=>r.id!==o.except):z.value,(r,ee)=>(e(),n(g,{key:r.id},[r.id!=="archivedSegment"||r.items.length?(e(),f(Y,{key:0,"show-caret":!0,"open-on-initial":!!r.items.length&&ee===0,"storage-key":r.id},{header:l(()=>[t("span",null,m(r.name),1),r.showCounter?(e(),n("span",mt,m(r.items.length||""),1)):y("",!0),r.showPlus?(e(),f(X,{key:1,component:me,"component-props":{initialShared:r.id==="mySegment"?"0":"1"}},{default:l(({open:p})=>[t("span",{class:"icon",onClick:N(p,["stop"])},$t,8,ft)]),_:2},1032,["component-props"])):y("",!0)]),default:l(()=>[r.id==="tags"?(e(),n("div",gt,[!r.items.length&&!a(v)?(e(),n("div",yt,m(b.$t("emptyList")),1)):y("",!0),u(ke,{"entity-type":"contact",tags:r.items},null,8,["tags"])])):(e(),n(g,{key:1},[!r.items.length&&!a(v)?(e(),n("div",kt,m(b.$t("emptyList")),1)):(e(),f(Q,{key:1},{default:l(()=>[(e(!0),n(g,null,R(r.items,p=>(e(),f(Z,{key:p.id,to:{name:r.routeName,params:{id:p.id}},custom:""},{default:l(({isActive:te,href:se,navigate:ne})=>[u(W,{selected:te},{default:l(()=>[j((e(),n("a",{href:se,class:I(b.$constant.parentAppDisableRouterClass),onClick:ne},["icon"in p?(e(),f(L,{key:0,size:20,url:p.icon_path,"fa-icon":p.icon,"disable-rounded":!0},null,8,["url","fa-icon"])):"responsible"in p?(e(),f(L,{key:1,size:20,url:p.responsible.userpic},null,8,["url"])):"color"in p?(e(),f(L,{key:2,size:20,"fa-icon":"circle","icon-color":p.color},null,8,["icon-color"])):y("",!0),t("span",St,m(p.count),1),t("span",Ct,m(p.name),1)],10,vt)),[[a(ye),p.name,void 0,{right:!0,700:!0}]])]),_:2},1032,["selected"])]),_:2},1032,["to"]))),128))]),_:2},1024))],64))]),_:2},1032,["open-on-initial","storage-key"])):y("",!0)],64))),128))]),_:1})}}}),wt=C({__name:"ContactsSidebar",setup(d){return(o,i)=>(e(),f(D,{space:"4",class:"tw-my-4"},{default:l(()=>[u(st),u(pt),u(H,{only:"mySegment"}),u(Ue),u(H,{except:"mySegment"})]),_:1}))}}),ts=C({__name:"ContactsView",setup(d){return(o,i)=>{const _=V("RouterView");return e(),f(oe,{slidable:!0,onVnodeMounted:i[0]||(i[0]=s=>{var c;return(c=a(_e))==null?void 0:c.setTitle(o.$t("contacts"))})},{sidebar:l(()=>[u(wt)]),default:l(()=>[u(_)]),_:1},512)}}});export{ts as default};
