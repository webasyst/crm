import{aq as y,U as B,d as b,Q as g,a as h,o as u,b as D,aa as w,w as d,i as n,k as l,c as p,f as $,m,F as v,e as N,W as F,p as S,B as C,b7 as V}from"./main-07d84941.js";import{B as M}from"./ButtonSubmit-7647b2fd.js";function P(i,t=!1){const{deleteDealsByIdsInList:e}=y();return B(`crm.deal.delete${t?"":`?id=${i[0]}`}`,{immediate:!1,afterFetch(s){return s.response.ok&&e(i),s}}).delete(t?{id:i}:null)}const R={class:"gray"},U={key:0,class:"tw-ml-2 small break-words"},E={class:"semibold"},I=n("i",{class:"state-caution fas fa-exclamation-triangle"},null,-1),T={class:"state-error"},z=b({__name:"FormDealDelete",props:{ids:{},isBulkMode:{type:Boolean},dealName:{},disableDealsPageRedirect:{type:Boolean},callbackSuccess:{type:Function}},emits:["close"],setup(i,{emit:t}){const e=i,s=g(),o=h(""),r=h(!1);async function c(){var k;o.value="",r.value=!0;const{error:a,response:f,execute:_}=P(e.ids,e.isBulkMode);await _(),r.value=!1,(k=f.value)!=null&&k.ok?(typeof e.callbackSuccess=="function"&&e.callbackSuccess(),e.disableDealsPageRedirect?t("close"):s.push({name:"deals"}).then(()=>{t("close")})):o.value=a.value?a.value:null}return(a,f)=>(u(),D(F,{"use-cancel-as-button-label":"","hide-close-icon":"",onClose:f[0]||(f[0]=_=>t("close"))},w({header:d(()=>[n("span",R,l(a.$t(e.isBulkMode?"confirmDeleteDeals":"delete",a.ids.length)),1),!e.isBulkMode&&e.dealName?(u(),p("span",U,l(e.dealName),1)):$("",!0)]),default:d(()=>[e.isBulkMode?(u(),p(v,{key:0},[n("p",null,l(a.$t("contactsWillNotBeDeleted")),1),n("p",E,[I,m(" "+l(a.$t("dealDeletionCannotBeUndone")),1)])],64)):(u(),p(v,{key:1},[m(l(a.$t("confirmDeleteDeal")),1)],64))]),submit:d(()=>[N(M,{bg:"red","is-fetching":r.value,onClick:c},{default:d(()=>[m(l(a.$t("delete")),1)]),_:1},8,["is-fetching"])]),_:2},[o.value?{name:"error",fn:d(()=>[n("span",T,l(o.value),1)]),key:"0"}:void 0]),1024))}}),W=n("span",{class:"icon size-20"},[n("i",{class:"fas fa-arrow-left"})],-1),A=[W],O=b({__name:"DealNavigateBack",setup(i){async function t(e){if(C.webView){const{emitter:c}=await V(()=>import("./main-07d84941.js").then(a=>a.bA),[],import.meta.url);c.emit("spa:navigateBack");return}const{back:s,content_uri:o}=window.history.state,r=c=>/\/deal\/\d+\/\w+/.test(c);typeof s=="string"&&!r(s)||typeof o=="string"&&!r(o)?e.back():e.push({name:"deals"})}return(e,s)=>(u(),p("a",{style:{color:"var(--deal-color-gray-secondary)"},onClick:s[0]||(s[0]=S(o=>t(e.$router),["prevent"]))},A))}});export{O as _,z as a};
