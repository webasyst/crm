import{d as F,a as o,B as i,A as h,U as S,P as $,g,o as n,b as u,c as E,k as L,w as m,e as w,f as N,i as y,a7 as V}from"./main-49799bbb.js";import{_ as D}from"./LazyLoadingWithProgress.vue_vue_type_script_setup_true_lang-2b9243c9.js";import{E as U}from"./EmptyList-c3da84c8.js";import{C as z,_ as O}from"./ContactsListItems-2449c47a.js";import{S as T}from"./SkeletonList-7258d9b0.js";import"./index-824b3191.js";import"./CustomColumn-69543086.js";import"./index-55296fc3.js";import"./UserPic-0ac47e38.js";import"./ChipsList-2cf36f72.js";import"./ContactsListItemAction.vue_vue_type_style_index_0_lang-3014a49e.js";import"./dayjs-16abfa33.js";import"./vTooltip-05cbcfb0.js";const j={key:1,class:"state-error tw-p-4"},A=y("div",{class:"icon size-80"},[y("i",{class:"fas fa-user-friends"})],-1),k=30,at=F({__name:"ContactTabsEmployees",props:{contactId:{}},setup(b){var p,v,_;const x=b,a=o([]),e=o(null),r=o(null),l=o(0),s=o({fields:(p=i.contact_list_columns)==null?void 0:p.map(t=>t.field),hash:`crmSearch/contact_info.company_contact_id=${x.contactId}`,sort:(v=i.contact_list_sort)==null?void 0:v.field,asc:(_=i.contact_list_sort)!=null&&_.asc?1:0,limit:k}),C=h(()=>`crm.contact.list?${V.stringify(s.value)}`),B=h(()=>{var t;return(((t=e.value)==null?void 0:t.columns)||[]).filter(c=>c.id!=="name")}),{data:I,isFetching:f}=S(C,{immediate:!0,refetch:!0}).get().json();$(I,async t=>{r.value=null,t&&(e.value&&t.params.offset>l.value?(a.value=[...a.value,...t.data],l.value=t.params.offset):(a.value=t.data,l.value=t.params.offset),e.value=t.params)});function d(t){e.value&&(s.value={...s.value,offset:0,...t,_:Date.now()})}function P(){d({offset:l.value+k})}return(t,c)=>g(f)&&!s.value.offset?(n(),u(T,{key:0,class:"box","row-height":"32px"})):r.value?(n(),E("div",j,L(r.value),1)):a.value.length?a.value.length&&e.value?(n(),u(O,{key:3,breakpoint:["md"],"trigger-class":["tw-group/md-contacts"],class:"tw-absolute tw-w-full tw-h-full tw-flex tw-flex-col tw-bg-waBlank"},{default:m(()=>[w(z,{contacts:a.value,"header-columns":B.value,"fetch-params":s.value,sort:e.value.sort,"disable-sync-settings":!0,onUpdateFetchParams:d},{lazyloadDown:m(()=>[w(D,{"entity-type":"contacts","count-loaded":a.value.length,"limit-load":s.value.limit,total:e.value.total_count,class:"tw-my-4",onVIntersectionObserver:c[0]||(c[0]=()=>{g(f)||P()})},null,8,["count-loaded","limit-load","total"])]),_:1},8,["contacts","header-columns","fetch-params","sort"])]),_:1})):N("",!0):(n(),u(U,{key:2,message:t.$t("noContacts")},{default:m(()=>[A]),_:1},8,["message"]))}});export{at as default};
