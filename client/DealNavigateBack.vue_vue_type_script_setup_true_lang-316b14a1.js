import{as as B,X as y,d as v,S as g,h,o as u,i as D,ab as w,w as d,a as n,p as l,c as p,j as $,A as m,F as b,b as N,W as S,e as F,B as C,ba as V}from"./main-82f77a11.js";import{B as M}from"./ButtonSubmit-93a0fe68.js";function P(i,t=!1){const{deleteDealsByIdsInList:e}=B();return y(`crm.deal.delete${t?"":`?id=${i[0]}`}`,{immediate:!1,afterFetch(s){return s.response.ok&&e(i),s}}).delete(t?{id:i}:null)}const R={class:"gray"},E={key:0,class:"tw-ml-2 small break-words"},I={class:"semibold"},T=n("i",{class:"state-caution fas fa-exclamation-triangle"},null,-1),U={class:"state-error"},z=v({__name:"FormDealDelete",props:{ids:{},isBulkMode:{type:Boolean},dealName:{},disableDealsPageRedirect:{type:Boolean},callbackSuccess:{type:Function}},emits:["close"],setup(i,{emit:t}){const e=i,s=g(),o=h(""),r=h(!1);async function c(){var k;o.value="",r.value=!0;const{error:a,response:f,execute:_}=P(e.ids,e.isBulkMode);await _(),r.value=!1,(k=f.value)!=null&&k.ok?(typeof e.callbackSuccess=="function"&&e.callbackSuccess(),e.disableDealsPageRedirect?t("close"):s.push({name:"deals"}).then(()=>{t("close")})):o.value=a.value?a.value:null}return(a,f)=>(u(),D(S,{"use-cancel-as-button-label":"","hide-close-icon":"",onClose:f[0]||(f[0]=_=>t("close"))},w({header:d(()=>[n("span",R,l(a.$t(e.isBulkMode?"confirmDeleteDeals":"delete",a.ids.length)),1),!e.isBulkMode&&e.dealName?(u(),p("span",E,l(e.dealName),1)):$("",!0)]),default:d(()=>[e.isBulkMode?(u(),p(b,{key:0},[n("p",null,l(a.$t("contactsWillNotBeDeleted")),1),n("p",I,[T,m(" "+l(a.$t("dealDeletionCannotBeUndone")),1)])],64)):(u(),p(b,{key:1},[m(l(a.$t("confirmDeleteDeal")),1)],64))]),submit:d(()=>[N(M,{bg:"red","is-fetching":r.value,onClick:c},{default:d(()=>[m(l(a.$t("delete")),1)]),_:1},8,["is-fetching"])]),_:2},[o.value?{name:"error",fn:d(()=>[n("span",U,l(o.value),1)]),key:"0"}:void 0]),1024))}}),W=n("span",{class:"icon size-20"},[n("i",{class:"fas fa-arrow-left"})],-1),A=[W],O=v({__name:"DealNavigateBack",setup(i){async function t(e){if(C.webView){const{emitter:c}=await V(()=>import("./main-82f77a11.js").then(a=>a.bB),[],import.meta.url);c.emit("spa:navigateBack");return}const{back:s,content_uri:o}=window.history.state,r=c=>/\/deal\/\d+\/\w+/.test(c);typeof s=="string"&&!r(s)||typeof o=="string"&&!r(o)?e.back():e.push({name:"deals"})}return(e,s)=>(u(),p("a",{style:{color:"var(--deal-color-gray-secondary)"},onClick:s[0]||(s[0]=F(o=>t(e.$router),["prevent"]))},A))}});export{O as _,z as a};
