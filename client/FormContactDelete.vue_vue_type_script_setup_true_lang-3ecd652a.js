import{d as C,o as t,b as $,c as a,k as e,r as B,E as W,x,J as D,W as L,$ as y,g as s,w as f,m as c,i as l,F as i,p as I,e as _,f as N,l as k}from"./main-ec0df6a4.js";import{U as V}from"./UserPic-87c13a4a.js";import{W as M}from"./WaSpinner-13137cd2.js";import{W as P}from"./WaDialog-c7c19903.js";const R={key:1},j=C({__name:"WaDialogLoading",props:{isFetching:{type:Boolean},error:{}},setup(h){const d=h;return(r,m)=>d.isFetching?(t(),$(M,{key:0})):d.error?(t(),a("div",R,e(r.error),1)):B(r.$slots,"default",{key:2})}}),E=["disabled","onClick"],U={key:0},z={class:"tw-flex tw-flex-auto tw-w-1/2 tw-space-x-2 tw-items-center"},A={class:"tw-truncate"},J={class:"tw-flex-none"},T={class:"tw-whitespace-nowrap"},Q=C({__name:"FormContactDelete",props:{contactIds:{},disableContactsPageRedirect:{type:Boolean}},emits:["close"],setup(h,{emit:d}){const r=h,m=W(),u=x().deleteContacts(r.contactIds),n=D(`crm.contact.links?${L.stringify({id:r.contactIds})}`).get().json();async function b(){if(n.error.value){n.execute();return}await u.execute()&&(d("close"),r.disableContactsPageRedirect||m.push({name:"contacts"}))}return(o,g)=>(t(),$(P,{onClose:g[0]||(g[0]=p=>d("close"))},y({header:f(()=>[c(e(o.$t("deleteContacts"))+" ("+e(r.contactIds.length)+") ",1)]),submit:f(()=>[l("button",{disabled:s(n).isFetching.value||s(u).isFetching.value,onClick:I(b,["prevent"])},[s(n).isFetching.value?(t(),a(i,{key:0},[c(e(o.$t("checkingLinks")),1)],64)):s(n).error.value?(t(),a(i,{key:1},[c(e(o.$t("recheckLinks")),1)],64)):s(u).isFetching.value?(t(),a(i,{key:2},[c(e(o.$t("deleting")),1)],64)):(t(),a(i,{key:3},[c(e(o.$t("deleteAnyway")),1)],64))],8,E)]),default:f(()=>[_(j,{"is-fetching":s(n).isFetching.value,error:s(n).error.value},y({_:2},[s(n).data.value&&"linked_contacts"in s(n).data.value?{name:"default",fn:f(()=>[l("p",null,e(o.$t("deleteContactsMessage1")),1),s(n).data.value.linked_contacts.length?(t(),a("p",U,e(o.$t("deleteContactsMessage2")),1)):N("",!0),(t(!0),a(i,null,k(s(n).data.value.linked_contacts,p=>(t(),a("div",{key:p.id},[(t(!0),a(i,null,k(p.links,(v,F)=>(t(),a("div",{key:F},[(t(!0),a(i,null,k(v.roles,(w,S)=>(t(),a("div",{key:S,class:"tw-flex tw-space-x-2 tw-justify-between tw-py-1 bordered-bottom tw-text-sm"},[l("div",z,[_(V,{url:p.userpic,size:16},null,8,["url"]),l("div",A,e(p.name),1),l("div",J,e(v.app)+"/"+e(w.role),1)]),l("div",T,e(o.$t("links",w.count)),1)]))),128))]))),128))]))),128))]),key:"0"}:void 0]),1032,["is-fetching","error"])]),_:2},[s(u).isFetching.value?void 0:{name:"error",fn:f(()=>[c(e(s(u).error.value),1)]),key:"0"}]),1024))}});export{j as _,Q as a};
