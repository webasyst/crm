import{d as w,J as C,h as y,l as T,o as a,i as d,w as h,c as l,p as c,j as _,u as m,A as x,F as v,q as A,af as F,a as i,e as S}from"./main-82f77a11.js";import{C as b}from"./CustomColumn-096f9d5b.js";import{C as B,a as L}from"./ChipsList-bf475e53.js";import{a as I}from"./FieldCheckbox-c89d2635.js";const D={key:0,class:"hint"},E={key:1},K=i("div",{class:"spinner"},null,-1),M=[K],$=["onClick"],j={key:0},q=i("i",{class:"fas fa-spinner tw-animate-spin"},null,-1),z=[q],J={key:1},N=i("i",{class:"fas fa-hashtag"},null,-1),U=[N],G={class:"tw-flex-auto tw-truncate"},H={class:"count tw-mt-0.5"},W=w({__name:"DropdownAddTags",props:{modelValue:{},entityType:{},entityIds:{}},emits:["update:modelValue"],setup(g,{emit:V}){const o=g,n=C();n.refetch();const r=y(""),u=y(new Set),p=T(()=>n.tags.filter(e=>!("tags"in o.modelValue?o.modelValue.tags:o.modelValue).map(t=>typeof t=="string"?t:t.name).includes(e.name)).sort((e,t)=>t.count-e.count).slice(0,10));function k(e){f(r.value),r.value="",e.target.blur()}async function f(e){Array.isArray(o.modelValue)?V("update:modelValue",[...o.modelValue,e]):(u.value.add(e),await n.tagAssign(o.entityType,o.entityIds,[e]).execute(),u.value.delete(e))}return(e,t)=>(a(),d(b,{space:"2"},{default:h(()=>[p.value.length>0?(a(),l("div",D,c(e.$t("popularTags")),1)):_("",!0),m(n).isFetching?(a(),l("div",E,M)):m(n).error?(a(),l(v,{key:2},[x(c(m(n).error),1)],64)):p.value.length>0?(a(),d(B,{key:3},{default:h(()=>[(a(!0),l(v,null,A(p.value,s=>(a(),d(L,{key:s.id,class:"smaller"},{default:h(()=>[i("a",{onClick:S(()=>{!u.value.has(s.name)&&f(s.name)},["prevent"])},[u.value.has(s.name)?(a(),l("span",j,z)):(a(),l("span",J,U)),i("span",G,c(s.name),1),i("span",H,c(s.count),1)],8,$)]),_:2},1024))),128))]),_:1})):_("",!0),m(n).isFetching?_("",!0):(a(),d(I,{key:4,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=s=>r.value=s),modelModifiers:{trim:!0},disabled:u.value.size,type:"text",placeholder:e.$t("createNewTag"),onKeyup:t[1]||(t[1]=F(s=>{r.value.length&&k(s)},["enter"]))},null,8,["modelValue","disabled","placeholder"]))]),_:1}))}});export{W as _};
