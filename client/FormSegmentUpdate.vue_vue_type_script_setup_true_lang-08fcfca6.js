import{$ as q,a0 as A,I as O,g as P,h as y,R as N,d as U,y as W,C as L,o as b,i as $,w as n,A as v,p as l,a as s,e as z,b as h,W as D,S as Q,l as G,N as J,u as w,j as K,c as X,F as Y,q as Z,n as _,T as ee}from"./main-82f77a11.js";import{C as B}from"./CustomColumn-096f9d5b.js";import{a as te,_ as M}from"./FieldCheckbox-c89d2635.js";import{_ as ae}from"./InputWithContacts.vue_vue_type_script_setup_true_lang-cc1fd72c.js";import{u as se}from"./validation-102b744f.js";const Ve=q("sidebar",()=>{const f=A(),d=O("(min-width: 1024px)"),e=P("show-sidebar",!1),u=y(d.value?e.value:!1);return f.redirectedFrom||(u.value=!1),N(()=>f.fullPath,()=>{u.value=!1}),N(u,m=>{document.documentElement.classList[m?"add":"remove"]("sidebarOpened"),d.value&&(e.value=m)},{immediate:!0}),{showSidebar:u}}),oe={class:"gray"},ne=["disabled","onClick"],le=U({__name:"FormContactsAddToSegment",props:{segment:{}},emits:["close"],setup(f,{emit:d}){const e=f,u=W(),m=L(),a=y([]),c=y();async function S(){a.value.length&&(c.value=m.includeContactsToSegment(e.segment.id,a.value.map(g=>g.id)),await c.value.execute(),c.value.error||(u.updateFetchParams(),d("close")))}return(g,p)=>(b(),$(D,{"use-cancel-as-button-label":!0,onClose:p[1]||(p[1]=i=>d("close"))},{header:n(()=>[v(l(g.$t("addContactsToSegment"))+" ",1),s("span",oe,l(e.segment.name),1)]),submit:n(()=>{var i;return[s("button",{class:"button",disabled:!!((i=c.value)!=null&&i.isFetching)||!a.value.length,onClick:z(S,["prevent"])},l(g.$t("save")),9,ne)]}),error:n(()=>{var i;return[v(l((i=c.value)==null?void 0:i.error),1)]}),default:n(()=>[h(ae,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=i=>a.value=i)},null,8,["modelValue"])]),_:1}))}}),ie=["disabled"],re={class:"tw-flex tw-space-x-2"},de={class:"tw-flex-none tw-w-32 small gray tw-break-words"},ue=s("i",{class:"fas fa-user-friends"},null,-1),ce={class:"hint"},me=s("i",{class:"fas fa-filter"},null,-1),pe={class:"hint"},fe={class:"tw-flex tw-space-x-2"},ge={class:"tw-flex-none tw-w-32 small gray tw-break-words"},he={class:"tw-flex tw-flex-wrap"},ve=["onClick"],we={class:"tw-flex tw-space-x-2"},be={class:"tw-flex-none tw-w-32 small gray tw-break-words"},Fe=U({__name:"FormSegmentUpdate",props:{initialShared:{},initialType:{},initialName:{},initialHash:{},segment:{}},emits:["close"],setup(f,{emit:d}){var C,k,V,F,T,x;const e=f,u=["user-friends","search","user","folder","file","lock","lock-open","brush","star","pencil-alt","bolt","lightbulb","images","chart-bar","book","map-marker-alt","camera","hourglass-end","cat","anchor","seedling","car-alt","save","cookie","radiation-alt","film","bug","clock","coffee","home","apple-alt","briefcase","guitar","smile","futbol","bullseye","award","phone-alt","store","shopping-cart","pen-alt","life-ring","columns"],m=Q(),a=y({name:((C=e.segment)==null?void 0:C.name)??e.initialName??"",type:((k=e.segment)==null?void 0:k.type)??e.initialType??"category",icon:((V=e.segment)==null?void 0:V.icon)??"",shared:(F=e.segment)!=null&&F.shared?"1":e.initialShared??"0",hash:((T=e.segment)==null?void 0:T.hash)??e.initialHash??""}),{validation:c,validate:S}=se(a,{name:"required"}),g=G(()=>{if(e.segment){const{type:t,hash:r,...o}=a.value;return o}return a.value}),p=L(),{data:i,isFetching:H,error:E,execute:I}=p[e.segment?"updateSegment":"addSegment"](g,(x=e.segment)==null?void 0:x.id);e.initialHash||J(()=>{a.value.hash=a.value.type==="search"?"crmSearch/":""});async function R(){if(S()&&await I()&&(d("close"),!e.segment)){m.push({name:"segment",params:{id:i.value.id}});const t=p.getSegmentById(i.value.id);(t==null?void 0:t.type)==="category"&&ee(le,{segment:t}).show(),(t==null?void 0:t.type)==="search"&&m.push({name:e.initialHash?"segment":"updateSegmentFilter",params:{id:t.id}})}}return(t,r)=>(b(),$(D,{onClose:r[3]||(r[3]=o=>d("close"))},{header:n(()=>[v(l(t.$t(`${e.segment?"update":"create"}Segment`)),1)]),submit:n(()=>[s("button",{class:"button",disabled:w(H),onClick:R},l(t.$t(e.segment?"update":"create")),9,ie)]),error:n(()=>[v(l(w(E)),1)]),default:n(()=>[h(B,{space:"6"},{default:n(()=>[s("div",re,[s("div",de,l(t.$t("name")),1),s("div",null,[h(B,{space:"2"},{default:n(()=>[h(te,{modelValue:a.value.name,"onUpdate:modelValue":r[0]||(r[0]=o=>a.value.name=o),type:"text",error:w(c).name.error,"error-message":w(c).name.errorMessage},null,8,["modelValue","error","error-message"]),e.segment?K("",!0):(b(),$(M,{key:0,modelValue:a.value.type,"onUpdate:modelValue":r[1]||(r[1]=o=>a.value.type=o),vertical:!0,disabled:!!e.initialType,options:[{id:"category",value:t.$t("staticList")},{id:"search",value:t.$t("dynamicFilter")}]},{category:n(()=>[ue,v("Â "),s("span",ce,l(t.$t("staticListDesc")),1)]),search:n(()=>[me,s("span",pe,l(t.$t("dynamicFilterDesc")),1)]),_:1},8,["modelValue","disabled","options"]))]),_:1})])]),s("div",fe,[s("div",ge,l(t.$t("icon")),1),s("div",null,[s("div",he,[(b(),X(Y,null,Z(u,(o,j)=>s("div",{key:j,class:_(["tw-w-10 tw-h-10 tw-mr-1 tw-mb-1 tw-flex tw-items-center tw-justify-center tw-rounded-full tw-overflow-hidden tw-cursor-pointer",{"tw-bg-waBackground":a.value.icon===o}]),onClick:ye=>a.value.icon=o},[s("span",{class:_(["icon tw-opacity-50",{"tw-opacity-100":a.value.icon===o}])},[s("i",{class:_(`fas fa-${o}`)},null,2)],2)],10,ve)),64))])])]),s("div",we,[s("div",be,l(t.$t("permission")),1),s("div",null,[h(M,{modelValue:a.value.shared,"onUpdate:modelValue":r[2]||(r[2]=o=>a.value.shared=o),vertical:!0,options:[{id:"0",value:t.$t("onlyMe")},{id:"1",value:t.$t("allUsers")}]},null,8,["modelValue","options"])])])]),_:1})]),_:1}))}});export{Fe as _,le as a,Ve as u};
