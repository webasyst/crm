import{U as c}from"./UserPic-6b99ec27.js";import{_ as h}from"./InputWithDropDown.vue_vue_type_script_setup_true_lang-71ea280f.js";import{d as f,a as v,aw as w,o as x,b as y,w as i,i as a,e as u,k as r,g as m,U as V,x as I}from"./main-07d84941.js";const $={class:"icon size-20"},C=["title"],S={class:"tw-flex tw-items-center tw-space-x-2"},B={class:"icon size-20"},F=["title"],g=f({__name:"InputWithContacts",props:{modelValue:{default:()=>[]},isMultiple:{type:Boolean,default:!0},isCompany:{type:Boolean},textValue:{},onEnter:{},onItemSelect:{}},emits:["update:modelValue"],setup(p,{emit:d}){const t=p,o=v([]),l=w(async s=>{const n=s.includes("@")?"email":/^[+\-0-9() ]+$/.test(s)?"phone":"name.name",{data:e}=await V(`crm.contact.list?hash=crmSearch/contact_info.${n}*=${encodeURIComponent(`${I(s)}${t.isCompany?"&contact_info.contact_type.company=1":""}`)}&limit=10`).get().json();e.value&&(o.value=e.value.data)},300);return(s,n)=>(x(),y(h,{items:o.value.filter(e=>!t.modelValue.map(_=>_.id).includes(e.id)),value:t.modelValue,"text-value":t.textValue,"is-multiple":t.isMultiple,placeholder:s.$t("search"),"on-enter":t.onEnter,"on-item-select":t.onItemSelect,onInput:m(l),onFocus:m(l),onUpdate:n[0]||(n[0]=e=>{d("update:modelValue",e)})},{item:i(({item:e})=>[a("div",$,[u(c,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate",title:e.name},r(e.name),9,C)]),listItem:i(({item:e})=>[a("div",S,[a("div",B,[u(c,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate small",title:e.name},r(e.name),9,F)])]),_:1},8,["items","value","text-value","is-multiple","placeholder","on-enter","on-item-select","onInput","onFocus"]))}});export{g as _};
