import{U as i}from"./UserPic-e76d468d.js";import{a as f}from"./InputWithUsers.vue_vue_type_script_setup_true_lang-fe28f2e3.js";import{e as h}from"./helpers-c0c14d27.js";import{d as v,a as y,af as V,o as w,b as x,w as c,i as a,e as u,k as r,g as m,M as I}from"./main-ad3d4b2a.js";const $={class:"icon size-20"},C=["title"],S={class:"tw-flex tw-items-center tw-space-x-2"},B={class:"icon size-20"},F=["title"],k=v({__name:"InputWithContacts",props:{modelValue:{default:()=>[]},isMultiple:{type:Boolean,default:!0},isCompany:{type:Boolean},textValue:{},onEnter:{},onItemSelect:{}},emits:["update:modelValue"],setup(p,{emit:d}){const t=p,n=y([]),l=V(async s=>{const o=s.includes("@")?"email":/^[+\-0-9() ]+$/.test(s)?"phone":"name.name",{data:e}=await I(`crm.contact.list?hash=crmSearch/contact_info.${o}*=${encodeURIComponent(`${h(s)}${t.isCompany?"&contact_info.contact_type.company=1":""}`)}&limit=10`).get().json();e.value&&(n.value=e.value.data)},300);return(s,o)=>(w(),x(f,{items:n.value.filter(e=>!t.modelValue.map(_=>_.id).includes(e.id)),value:t.modelValue,"text-value":t.textValue,"is-multiple":t.isMultiple,placeholder:s.$t("search"),"on-enter":t.onEnter,"on-item-select":t.onItemSelect,onInput:m(l),onFocus:m(l),onUpdate:o[0]||(o[0]=e=>{d("update:modelValue",e)})},{item:c(({item:e})=>[a("div",$,[u(i,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate",title:e.name},r(e.name),9,C)]),listItem:c(({item:e})=>[a("div",S,[a("div",B,[u(i,{url:e.userpic,size:20},null,8,["url"])]),a("span",{class:"tw-truncate small",title:e.name},r(e.name),9,F)])]),_:1},8,["items","value","text-value","is-multiple","placeholder","on-enter","on-item-select","onInput","onFocus"]))}});export{k as _};
